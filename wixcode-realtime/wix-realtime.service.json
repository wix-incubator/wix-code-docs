{ "name": "wix-realtime",
  "mixes": [],
  "labels":
    [ "changed" ],
  "location":
    { "lineno": 1,
      "filename": "realtime.js" },
  "docs":
    { "summary": "The wix-realtime module contains functionality for publishing messages\n on channels that site visitors can subscribe to.",
      "description":
        [ "Using the Realtime API you can create channels and channel resources where messages",
          " can be published. Site visitors who subscribe to a channel receive the published",
          " messages published to that channel.",
          "",
          " The `wix-realtime` module is used in conjunction with the ",
          " [`wix-realtime-backend`](wix-realtime-backend.html) module.",
          "",
          " Typical uses of the Realtime API include implementing a messaging system or",
          " as an alternative to using a polling mechanism.",
          "",
          " The Realtime API uses the following terminology:",
          "",
          " + **Channel**: A specific channel on which messages are published. Each channel",
          "   has a unique name. Site visitors can subscribe to a channel to receive the ",
          "   messages that are published on it.",
          " + **Channel resource**: A subchannel on which messages are published. Subchannels",
          "   can share a name with a channel and other subchannels, but they have a unique",
          "   resource ID. ",
          " + **Message**: A message published on a channel or channel resource. A message can",
          "   be of any type. Channel subscribers receive the messages published on the channel.",
          " + **Publish**: Sending a message over a channel or channel resource.",
          " + **Subscribe**: A site visitor subscribes to receive the messages published on a ",
          "   channel or channel resource.",
          "",
          "",
          " To use the Realtime API, import `wixRealtime` from the `wix-realtime` module:",
          "",
          "   ```javascript",
          "   import wixRealtime from 'wix-realtime';",
          "   ```" ],
      "links": [],
      "examples": [],
      "extra":
        {  } },
  "properties": [],
  "operations":
    [ { "name": "onConnected",
        "labels": [],
        "nameParams": [],
        "params":
          [ { "name": "handler",
              "type": "wix-realtime.ConnectionHandler",
              "doc": "The name of the function or\n the function expression to run when a connection occurs." } ],
        "ret":
          { "type": "void" },
        "locations":
          [ { "lineno": 194,
              "filename": "realtime.js" } ],
        "docs":
          { "summary": "Adds an event handler that runs when a connection or reconnection\n occurs.",
            "description":
              [ "A connection occurs when subscribing to a channel or channel resource or ",
                " when an existing connection is lost and then restored." ],
            "links": [],
            "examples":
              [ { "title": "Add a connection handler",
                  "body":
                    [ "import wixRealtime from 'wix-realtime';",
                      "",
                      "// ...",
                      "",
                      "wixRealtime.onConnected( () => {",
                      "  // handle connection",
                      "  $w(\"disconnectedMessage\").hide();",
                      "} );" ],
                  "extra":
                    {  } } ],
            "extra":
              {  } },
        "extra":
          {  } },
      { "name": "onDisconnected",
        "labels": [],
        "nameParams": [],
        "params":
          [ { "name": "handler",
              "type": "wix-realtime.DisconnectionHandler",
              "doc": "The name of the function or\n the function expression to run when a disconnection occurs." } ],
        "ret":
          { "type": "void" },
        "locations":
          [ { "lineno": 214,
              "filename": "realtime.js" } ],
        "docs":
          { "summary": "Adds an event handler that runs when a disconnection occurs.",
            "description":
              [ "A disconnection can occur, for example, if there is a network issue." ],
            "links": [],
            "examples":
              [ { "title": "Add a connection handler",
                  "body":
                    [ "import wixRealtime from 'wix-realtime';",
                      "",
                      "// ...",
                      "",
                      "wixRealtime.onDisconnected( () => {",
                      "  // handle disconnection",
                      "  $w(\"disconnectedMessage\").show();",
                      "} );" ],
                  "extra":
                    {  } } ],
            "extra":
              {  } },
        "extra":
          {  } },
      { "name": "onError",
        "labels": [],
        "nameParams": [],
        "params":
          [ { "name": "handler",
              "type": "wix-realtime.ErrorHandler",
              "doc": "The name of the function or\n the function expression to run when an error occurs." } ],
        "ret":
          { "type": "void" },
        "locations":
          [ { "lineno": 173,
              "filename": "realtime.js" } ],
        "docs":
          { "summary": "Adds an event handler that runs when an error occurs.",
            "description":
              [ "An error can occur when attempting to resubscribe after a disconnection.",
                " Errors that occur during the initial subscription process cause the",
                " Promise returned by the [`subscribe()`](#subscribe) function to reject",
                " and do not trigger `onError()` event handlers." ],
            "links": [],
            "examples":
              [ { "title": "Add an error handler",
                  "body":
                    [ "import wixRealtime from 'wix-realtime';",
                      "",
                      "// ...",
                      "",
                      "wixRealtime.onError( (error) => {",
                      "  let code = error.errorCode;",
                      "  let message = error.message;",
                      "  if(channel) {",
                      "    let channelName = error.channel.name;",
                      "    let resourceId = error.channel.resourceId;",
                      "  }",
                      "} );" ],
                  "extra":
                    {  } } ],
            "extra":
              {  } },
        "extra":
          {  } },
      { "name": "subscribe",
        "labels":
          [ "changed" ],
        "nameParams": [],
        "params":
          [ { "name": "channel",
              "type": "wix-realtime.Channel",
              "doc": "The channel, and optionally the resource, to \n subscribe to." },
            { "name": "handler",
              "type": "wix-realtime.MessageHandler",
              "doc": "The name of the function or\n the function expression to run when something is published to the channel or \n channel resource subscribed to." } ],
        "ret":
          { "type":
              { "name": "Promise",
                "typeParams":
                  [ "string" ] },
            "doc": "Fulfilled - An ID representing the subscription, used for unsubscribing.\nRejected - Error that caused the rejection." },
        "locations":
          [ { "lineno": 75,
              "filename": "realtime.js" } ],
        "docs":
          { "summary": "Subscribes to a channel or channel resource.",
            "description":
              [ "The `subscribe()` function subscribes to receive messages published on the",
                " specified channel or channel resource. ",
                "",
                " When you subscribe to a channel you do not receive messages published to",
                " a resource on that same channel. To receive those messages, you must",
                " explicitly subscribe to the specific resource.",
                "",
                " The specified message handler is run each time a message is published on",
                " the given channel or channel resource. Use it to define what happens when",
                " messages are received.",
                "",
                " You can subscribe to a channel or channel resource more than once to add",
                " multiple message handlers. Each subscription returns a unique subscription",
                " ID which can be used later to unsubscribe from the specific subscription ",
                " with that ID, without affecting the other subscriptions on the same channel",
                " or channel resource." ],
            "links": [],
            "examples":
              [ { "title": "Subscribe to a channel",
                  "body":
                    [ "import wixRealtime from 'wix-realtime';",
                      "",
                      "// ...",
                      "",
                      "const channel = {\"name\": \"someChannel\"};",
                      "",
                      "wixRealtime.subscribe(channel, (message, channel) => {",
                      "  let payload = message.payload;",
                      "  let channelName = channel.name;",
                      "  if(message.publisher) {",
                      "    let publisherId = message.publisher.uid;",
                      "  }",
                      "})",
                      ".then((id) => {",
                      "  subscriptionId = id;",
                      "});" ],
                  "extra":
                    {  } },
                { "title": "Subscribe to a resource on a channel",
                  "body":
                    [ "import wixRealtime from 'wix-realtime';",
                      "",
                      "// ...",
                      "",
                      "const channel = {",
                      "  \"name\": \"someChannel\",",
                      "  \"resourceId\": \"someId\"",
                      "};",
                      "let subscriptionId;",
                      "",
                      "wixRealtime.subscribe(channel, (message, channel) => {",
                      "  let payload = message.payload;",
                      "  let channelName = channel.name;",
                      "  let resourceId = channel.resourceId;",
                      "  if(message.publisher) {",
                      "    let publisherId = message.publisher.uid;",
                      "  }",
                      "})",
                      ".then((id) => {",
                      "  subscriptionId = id;",
                      "});" ],
                  "extra":
                    {  } } ],
            "extra":
              {  } },
        "extra":
          {  } },
      { "name": "unsubscribe",
        "labels":
          [ "changed" ],
        "nameParams": [],
        "params":
          [ { "name": "unsubscribeOptions",
              "type": "wix-realtime.UnsubscribeOptions",
              "doc": "Options to use when unsubscribing." } ],
        "ret":
          { "type":
              { "name": "Promise",
                "typeParams":
                  [ "void" ] },
            "doc": "Fulfilled - When unsubscribed from the channel or channel resource.\nRejected - Error that caused the rejection." },
        "locations":
          [ { "lineno": 119,
              "filename": "realtime.js" } ],
        "docs":
          { "summary": "Unsubscribes from a channel or channel resource.",
            "description":
              [ "The `unsubscribe()` function unsubscribes from receiving messages published",
                " on the specified channel or channel resource. ",
                "",
                " + Use the `channel` property of the [`UnsubscribeOptions`](UnsubscribeOptions) object",
                "   passed to the `options` parameter to unsubscribe from all subscriptions to a",
                "   specific channel or channel resource.",
                "",
                "   When you unsubscribe from a channel you do not unsubscribe from the",
                "   resources on that same channel. To no longer receive messages on a",
                "   channel resource, you must explicitly unsubscribe from the specific resource.",
                "",
                " + Use the `subscriptionId` property of the [`UnsubscribeOptions`](UnsubscribeOptions) object",
                "   passed to the `options` parameter to unsubscribe from a specific subscription.",
                "",
                "   This option is typically used when you have more than one subscription to the same",
                "   channel or channel resource and you only want to unsubscribe from one of those subscriptions.",
                "",
                "   Get a subscription's `subscriptionId` from the resolution of the Promise returned",
                "   when creating the subscription with the [`subscribe()`](#subscribe) function." ],
            "links": [],
            "examples":
              [ { "title": "Unsubscribe all subscriptions from a channel",
                  "body":
                    [ "import wixRealtime from 'wix-realtime';",
                      "",
                      "// ...",
                      "",
                      "const someChannel = {\"name\": \"someChannel\"};",
                      "let subscriptionId1;",
                      "let subscriptionId2;",
                      "",
                      "// first subscription to a channel ",
                      "wixRealtime.subscribe(someChannel, messageHandler1)",
                      "  .then( (id) => {",
                      "    subscriptionId1 = id;",
                      "  }) ;",
                      "",
                      "// second subscription to the same channel",
                      "wixRealtime.subscribe(someChannel, messageHandler2)",
                      "  .then( (id) => {",
                      "    subscriptionId2 = id;",
                      "  }) ;",
                      "",
                      "// ...",
                      "",
                      "wixRealtime.unsubscribe({\"channel\": someChannel})",
                      "  .then( () => {",
                      "    // unsubscribed from all subscriptions to channel",
                      "  } );",
                      "",
                      "// ...",
                      "",
                      "function messageHandler1(message, channel){",
                      "  // handle channel messages",
                      "}",
                      "",
                      "function messageHandler2(message, channel){",
                      "  // handle channel messages",
                      "}" ],
                  "extra":
                    {  } },
                { "title": "Unsubscribe from a specific subscription to a channel",
                  "body":
                    [ "import wixRealtime from 'wix-realtime';",
                      "",
                      "// ...",
                      "",
                      "const someChannel = {\"name\": \"someChannel\"};",
                      "let subscriptionId1;",
                      "let subscriptionId2;",
                      "",
                      "// first subscription to a channel ",
                      "wixRealtime.subscribe(someChannel, messageHandler1)",
                      "  .then( (id) => {",
                      "    subscriptionId1 = id;",
                      "  }) ;",
                      "",
                      "// second subscription to the same channel",
                      "wixRealtime.subscribe(someChannel, messageHandler2)",
                      "  .then( (id) => {",
                      "    subscriptionId2 = id;",
                      "  }) ;",
                      "",
                      "// ...",
                      "",
                      "wixRealtime.unsubscribe({\"subscriptionId\": subscriptionId1})",
                      "  .then( () => {",
                      "    // unsubscribed from first subscription to channel",
                      "  } );",
                      "",
                      "// ...",
                      "",
                      "function messageHandler1(message, channel){",
                      "  // handle channel messages",
                      "}",
                      "",
                      "function messageHandler2(message, channel){",
                      "  // handle channel messages",
                      "}" ],
                  "extra":
                    {  } } ],
            "extra":
              {  } },
        "extra":
          {  } } ],
  "callbacks":
    [ { "name": "ConnectionHandler",
        "labels": [],
        "nameParams": [],
        "params": [],
        "ret":
          { "type": "void" },
        "locations":
          [ { "lineno": 188,
              "filename": "realtime.js" } ],
        "docs":
          { "description":
              [ "Handles connections." ],
            "links":
              [ "[onConnected( )](#onConnected)" ],
            "examples": [],
            "extra":
              {  } },
        "extra":
          {  } },
      { "name": "DisconnectionHandler",
        "labels": [],
        "nameParams": [],
        "params": [],
        "ret":
          { "type": "void" },
        "locations":
          [ { "lineno": 208,
              "filename": "realtime.js" } ],
        "docs":
          { "description":
              [ "Handles disconnections." ],
            "links":
              [ "[onDisonnected( )](#onDisonnected)" ],
            "examples": [],
            "extra":
              {  } },
        "extra":
          {  } },
      { "name": "ErrorHandler",
        "labels": [],
        "nameParams": [],
        "params":
          [ { "name": "error",
              "type": "wix-realtime.Error",
              "doc": "The error that occurred." } ],
        "ret":
          { "type": "void" },
        "locations":
          [ { "lineno": 167,
              "filename": "realtime.js" } ],
        "docs":
          { "description":
              [ "Handles realtime errors." ],
            "links": [],
            "examples": [],
            "extra":
              {  } },
        "extra":
          {  } },
      { "name": "MessageHandler",
        "labels": [],
        "nameParams": [],
        "params":
          [ { "name": "message",
              "type": "wix-realtime.Message",
              "doc": "The message that was published." },
            { "name": "channel",
              "type": "wix-realtime.Channel",
              "doc": "The channel the message was published on." } ],
        "ret":
          { "type": "void" },
        "locations":
          [ { "lineno": 67,
              "filename": "realtime.js" } ],
        "docs":
          { "description":
              [ "Handles a message published to a channel or channel resource." ],
            "links":
              [ "[subscribe( )](#subscribe)" ],
            "examples": [],
            "extra":
              {  } },
        "extra":
          {  } } ],
  "messages":
    [ { "name": "Channel",
        "locations":
          [ { "lineno": 38,
              "filename": "realtime.js" } ],
        "docs":
          { "summary": "An object representing a channel.",
            "links":
              [ "[subscribe( )](#subscribe)" ],
            "examples":
              [ { "title": "Subscribe to a channel",
                  "body":
                    [ "import wixRealtime from 'wix-realtime';",
                      "",
                      "// ...",
                      "",
                      "const channel = {\"name\": \"someChannel\"};",
                      "",
                      "wixRealtime.subscribe(channel, (message, channel) => {",
                      "  let payload = message.payload;",
                      "  let channelName = channel.name;",
                      "  if(message.publisher) {",
                      "    let publisherId = message.publisher.uid;",
                      "  }",
                      "})",
                      ".then((id) => {",
                      "  subscriptionId = id;",
                      "});" ],
                  "extra":
                    {  } },
                { "title": "Subscribe to a resource on a channel",
                  "body":
                    [ "import wixRealtime from 'wix-realtime';",
                      "",
                      "// ...",
                      "",
                      "const channel = {",
                      "  \"name\": \"someChannel\",",
                      "  \"resourceId\": \"someId\"",
                      "};",
                      "let subscriptionId;",
                      "",
                      "wixRealtime.subscribe(channel, (message, channel) => {",
                      "  let payload = message.payload;",
                      "  let channelName = channel.name;",
                      "  let resourceId = channel.resourceId;",
                      "  if(message.publisher) {",
                      "    let publisherId = message.publisher.uid;",
                      "  }",
                      "})",
                      ".then((id) => {",
                      "  subscriptionId = id;",
                      "});" ],
                  "extra":
                    {  } } ],
            "extra":
              {  } },
        "members":
          [ { "name": "name",
              "type": "string",
              "doc": "Channel name. Cannot exceed 140 characters." },
            { "name": "resourceId",
              "type": "string",
              "doc": "ID of a specific channel resource.",
              "optional": true } ],
        "extra":
          {  },
        "labels": [] },
      { "name": "Error",
        "locations":
          [ { "lineno": 151,
              "filename": "realtime.js" } ],
        "docs":
          { "summary": "An object representing an error.",
            "links":
              [ "[onError( )](#onError)" ],
            "examples":
              [ { "title": "Add an error handler",
                  "body":
                    [ "import wixRealtime from 'wix-realtime';",
                      "",
                      "// ...",
                      "",
                      "wixRealtime.onError( (error) => {",
                      "  let code = error.errorCode;",
                      "  let message = error.message;",
                      "  if(channel) {",
                      "    let channelName = error.channel.name;",
                      "    let resourceId = error.channel.resourceId;",
                      "  }",
                      "} );" ],
                  "extra":
                    {  } } ],
            "extra":
              {  } },
        "members":
          [ { "name": "errorCode",
              "type": "number",
              "doc": "Error code.\n \n One of:\n\n + `1`: Connection error\n + `2`: Subscription error (error will also include a channel value)\n + `3`: Bad input" },
            { "name": "message",
              "type": "string",
              "doc": "Error message." },
            { "name": "channel",
              "type": "wix-realtime.Channel",
              "doc": "Channel related to the error.",
              "optional": true } ],
        "extra":
          {  },
        "labels": [] },
      { "name": "Message",
        "locations":
          [ { "lineno": 57,
              "filename": "realtime.js" } ],
        "docs":
          { "summary": "An object representing a published message.",
            "links":
              [ "[subscribe( )](#subscribe)" ],
            "examples":
              [ { "title": "Subscribe to a channel",
                  "body":
                    [ "import wixRealtime from 'wix-realtime';",
                      "",
                      "// ...",
                      "",
                      "const channel = {\"name\": \"someChannel\"};",
                      "",
                      "wixRealtime.subscribe(channel, (message, channel) => {",
                      "  let payload = message.payload;",
                      "  let channelName = channel.name;",
                      "  if(message.publisher) {",
                      "    let publisherId = message.publisher.uid;",
                      "  }",
                      "})",
                      ".then((id) => {",
                      "  subscriptionId = id;",
                      "});" ],
                  "extra":
                    {  } },
                { "title": "Subscribe to a resource on a channel",
                  "body":
                    [ "import wixRealtime from 'wix-realtime';",
                      "",
                      "// ...",
                      "",
                      "const channel = {",
                      "  \"name\": \"someChannel\",",
                      "  \"resourceId\": \"someId\"",
                      "};",
                      "let subscriptionId;",
                      "",
                      "wixRealtime.subscribe(channel, (message, channel) => {",
                      "  let payload = message.payload;",
                      "  let channelName = channel.name;",
                      "  let resourceId = channel.resourceId;",
                      "  if(message.publisher) {",
                      "    let publisherId = message.publisher.uid;",
                      "  }",
                      "})",
                      ".then((id) => {",
                      "  subscriptionId = id;",
                      "});" ],
                  "extra":
                    {  } } ],
            "extra":
              {  } },
        "members":
          [ { "name": "payload",
              "type": "*",
              "doc": "Message payload." },
            { "name": "publisher",
              "type": "wix-realtime.Publisher",
              "doc": "Message publisher, if sent." } ],
        "extra":
          {  },
        "labels": [] },
      { "name": "Publisher",
        "locations":
          [ { "lineno": 48,
              "filename": "realtime.js" } ],
        "docs":
          { "summary": "An object representing a publisher.",
            "links":
              [ "[subscribe( )](#subscribe)" ],
            "examples":
              [ { "title": "Subscribe to a channel",
                  "body":
                    [ "import wixRealtime from 'wix-realtime';",
                      "",
                      "// ...",
                      "",
                      "const channel = {\"name\": \"someChannel\"};",
                      "",
                      "wixRealtime.subscribe(channel, (message, channel) => {",
                      "  let payload = message.payload;",
                      "  let channelName = channel.name;",
                      "  if(message.publisher) {",
                      "    let publisherId = message.publisher.uid;",
                      "  }",
                      "})",
                      ".then((id) => {",
                      "  subscriptionId = id;",
                      "});" ],
                  "extra":
                    {  } },
                { "title": "Subscribe to a resource on a channel",
                  "body":
                    [ "import wixRealtime from 'wix-realtime';",
                      "",
                      "// ...",
                      "",
                      "const channel = {",
                      "  \"name\": \"someChannel\",",
                      "  \"resourceId\": \"someId\"",
                      "};",
                      "let subscriptionId;",
                      "",
                      "wixRealtime.subscribe(channel, (message, channel) => {",
                      "  let payload = message.payload;",
                      "  let channelName = channel.name;",
                      "  let resourceId = channel.resourceId;",
                      "  if(message.publisher) {",
                      "    let publisherId = message.publisher.uid;",
                      "  }",
                      "})",
                      ".then((id) => {",
                      "  subscriptionId = id;",
                      "});" ],
                  "extra":
                    {  } } ],
            "extra":
              {  } },
        "members":
          [ { "name": "id",
              "type": "string",
              "doc": "ID of the publisher." } ],
        "extra":
          {  },
        "labels": [] },
      { "name": "UnsubscribeOptions",
        "locations":
          [ { "lineno": 108,
              "filename": "realtime.js" } ],
        "docs":
          { "summary": "An object containing options to be used when unsubscribing from a\n channel or channel resource subscription.",
            "links":
              [ "[unsubscribe( )](#unsubscribe)" ],
            "examples":
              [ { "title": "Unsubscribe from a specific subscription to a channel",
                  "body":
                    [ "import wixRealtime from 'wix-realtime';",
                      "",
                      "// ...",
                      "",
                      "const someChannel = {\"name\": \"someChannel\"};",
                      "let subscriptionId1;",
                      "let subscriptionId2;",
                      "",
                      "// first subscription to a channel ",
                      "wixRealtime.subscribe(someChannel, messageHandler1)",
                      "  .then( (id) => {",
                      "    subscriptionId1 = id;",
                      "  }) ;",
                      "",
                      "// second subscription to the same channel",
                      "wixRealtime.subscribe(someChannel, messageHandler2)",
                      "  .then( (id) => {",
                      "    subscriptionId2 = id;",
                      "  }) ;",
                      "",
                      "// ...",
                      "",
                      "wixRealtime.unsubscribe({\"subscriptionId\": subscriptionId1})",
                      "  .then( () => {",
                      "    // unsubscribed from first subscription to channel",
                      "  } );",
                      "",
                      "// ...",
                      "",
                      "function messageHandler1(message, channel){",
                      "  // handle channel messages",
                      "}",
                      "",
                      "function messageHandler2(message, channel){",
                      "  // handle channel messages",
                      "}" ],
                  "extra":
                    {  } } ],
            "extra":
              {  } },
        "members":
          [ { "name": "subscriptionId",
              "type": "string",
              "doc": "ID of the subscription to unsubscribe from.",
              "optional": true },
            { "name": "channel",
              "type": "wix-realtime.Channel",
              "doc": "The channel, and optionally the resource, to \n unsubscribe from.",
              "optional": true } ],
        "extra":
          {  },
        "labels":
          [ "changed" ] } ],
  "extra":
    {  } }