{ "name": "Events",
  "memberOf": "wix-marketing-backend",
  "mixes": [],
  "labels": [],
  "location":
    { "lineno": 1,
      "filename": "events.js" },
  "docs":
    { "summary": "Events that are triggered by actions related to Wix Marketing.",
      "description":
        [ "Wix  events are fired in your site's backend when certain events occur in your site's store.",
          " You can write event handlers that react to these events. Event handler functions",
          " receive data that corresponds to the event that has occurred. Use event handlers",
          " to create custom responses to marketing events.",
          "",
          " To add a marketing event handler, add an **events.js** file to the **Backend** section",
          " of your site if one does not already exist. All event handler functions for your",
          " site are defined in this file.",
          "",
          " Event handler functions are defined using the following pattern:",
          "",
          " ```javascript",
          " export function <wixAppName>_<eventName>(event) { }",
          " ```",
          "",
          " For example, an event handler that handles coupon creation in a Wix site looks",
          " like this:",
          "",
          " ```javascript",
          " export function wixMarketing_onCouponCreated(event) { }",
          " ```",
          "",
          " > **Note:** Backend events don't work when previewing your site." ],
      "links": [],
      "examples": [],
      "extra":
        {  } },
  "properties": [],
  "operations":
    [ { "name": "onCouponApplied",
        "labels": [],
        "nameParams": [],
        "params":
          [ { "name": "event",
              "type": "wix-marketing-backend.Events.CouponAppliedEvent",
              "doc": "Information about an applied coupon." } ],
        "ret":
          { "type": "void" },
        "locations":
          [ { "lineno": 134,
              "filename": "events.js" } ],
        "docs":
          { "summary": "An event that is triggered when a coupon is used.",
            "description":
              [ "The `onCouponApplied()` event handler runs when an order with an applied coupon is completed, or when an order is manually marked as paid.",
                "",
                "> **Note:** Backend events don't work when previewing your site." ],
            "links": [],
            "examples":
              [ { "title": "An event when a coupon is applied",
                  "body":
                    [ "// Place this code in the events.js file",
                      "// of your site's Backend section.",
                      "",
                      "export function wixMarketing_onCouponApplied(event) {",
                      "  const appliedCouponId = event.data.coupon._id;",
                      "  const appliedCouponName = event.data.coupon.name;",
                      "  const couponAppliedTime = event.metadata.eventTime;",
                      "  const appliedCouponOrderId = event.data.wixAppOrderId;",
                      "}",
                      "",
                      "/* Full event object",
                      " *",
                      " *  {",
                      " *    \"metadata\": {",
                      " *      \"id\": \"99a3d562-1650-40e6-97f5-3918e6ec94aa\",",
                      " *      \"entityId\": \"03a35393-7835-44b0-af53-6019a484b48b\",",
                      " *      \"eventTime\": \"2021-07-17T11:56:03.852350Z\",",
                      " *      \"triggeredByAnonymizeRequest\": false",
                      " *    },",
                      " *    \"data\": {",
                      " *      \"coupon\": {",
                      " *        \"_id\": \"03a35393-7835-44b0-af53-6019a484b48b\",",
                      " *        \"name\": \"Summer Sale 10% off\",",
                      " *        \"code\": \"SummerSale\",",
                      " *        \"startTime\": \"Wed Jun 30 2021 21:00:00 GMT+0000 (Coordinated Universal Time)\",",
                      " *        \"expirationTime\": \"Tue Aug 31 2021 20:59:59 GMT+0000 (Coordinated Universal Time)\",",
                      " *        \"limitPerCustomer\": 1,",
                      " *        \"active\": true,",
                      " *        \"scope\": {",
                      " *          \"namespace\": \"stores\",",
                      " *          \"group\": {",
                      " *            \"name\": \"product\",",
                      " *            \"entityId\": \"5376f9ec-b92e-efa9-e4a1-f4f480aa0d3a\"",
                      " *          }",
                      " *        },",
                      " *        \"_dateCreated\": \"Sun Jan 17 2021 11:40:56 GMT+0000 (Coordinated Universal Time)\",",
                      " *        \"numberOfUsages\": 1,",
                      " *        \"expired\": false,",
                      " *        \"displayData\": {",
                      " *          \"name\": \"Indonesian Blend\",",
                      " *          \"formattedPrice\": \"$35.00\",",
                      " *          \"mediaItem\": \"https://static.wixstatic.com/media/nsplsh_316b6449475f3235386255~mv2_d_2977_3951_s_4_2.jpg/v1/fit/w_2977,h_3951,q_90/file.jpg\"",
                      " *        },",
                      " *        \"limitedToOneItem\": false,",
                      " *        \"type\": \"PercentOff\",",
                      " *        \"percentOffRate\": 10",
                      " *      },",
                      " *      \"wixAppId\": \"215238eb-22a5-4c36-9e7b-e7c08025e04e\",",
                      " *      \"wixAppOrderId\": \"6758b1bc-539f-430c-a0ea-889130ef3351\"",
                      " *    }",
                      " *  }",
                      " *",
                      " */" ],
                  "extra":
                    {  } } ],
            "extra":
              {  } },
        "extra":
          {  } },
      { "name": "onCouponCreated",
        "labels": [],
        "nameParams": [],
        "params":
          [ { "name": "event",
              "type": "wix-marketing-backend.Events.CouponEvent",
              "doc": "Information about a newly created coupon." } ],
        "ret":
          { "type": "void" },
        "locations":
          [ { "lineno": 67,
              "filename": "events.js" } ],
        "docs":
          { "summary": "An event that is triggered when a coupon is created.",
            "description":
              [ "The `onCouponCreated()` event handler runs when a new coupon is created.",
                "",
                "> **Note:** Backend events don't work when previewing your site." ],
            "links":
              [ "[`createCoupon()`](https://www.wix.com/corvid/reference/wix-marketing-backend/coupons-obj/createcoupon)" ],
            "examples":
              [ { "title": "An event when a coupon is created",
                  "body":
                    [ "// Place this code in the events.js file",
                      "// of your site's Backend section.",
                      "",
                      "export function wixMarketing_onCouponCreated(event) {",
                      "  const newCouponId = event.entity._id;",
                      "  const newCouponType = event.entity.type;",
                      "  const couponValidFrom = event.entity.startTime;",
                      "}",
                      "",
                      "/* Full event object",
                      " *",
                      " *  {",
                      " *    \"metadata\": {",
                      " *      \"id\": \"c4ea2c0a-0952-48ad-9b15-39e660448663\",",
                      " *      \"entityId\": \"03a35393-7835-44b0-af53-6019a484b48b\",",
                      " *      \"eventTime\": \"2021-01-17T11:40:56.795047Z\",",
                      " *      \"triggeredByAnonymizeRequest\": false",
                      " *    },",
                      " *    \"entity\": {",
                      " *      \"_id\": \"03a35393-7835-44b0-af53-6019a484b48b\",",
                      " *      \"name\": \"Summer Sale 10% off\",",
                      " *      \"code\": \"SummerSale\",",
                      " *      \"startTime\": \"Wed Jun 30 2021 21:00:00 GMT+0000 (Coordinated Universal Time)\",",
                      " *      \"expirationTime\": \"Tue Aug 31 2021 20:59:59 GMT+0000 (Coordinated Universal Time)\",",
                      " *      \"limitPerCustomer\": 1,",
                      " *      \"active\": true,",
                      " *      \"scope\": {",
                      " *        \"namespace\": \"stores\"",
                      " *      },",
                      " *      \"_dateCreated\": \"Sun Jan 17 2021 11:40:56 GMT+0000 (Coordinated Universal Time)\",",
                      " *      \"expired\": false,",
                      " *      \"displayData\": null,",
                      " *      \"limitedToOneItem\": true,",
                      " *      \"type\": \"PercentOff\",",
                      " *      \"percentOffRate\": 10",
                      " *    }",
                      " *  }",
                      " *",
                      " */" ],
                  "extra":
                    {  } } ],
            "extra":
              {  } },
        "extra":
          {  } },
      { "name": "onCouponDeleted",
        "labels": [],
        "nameParams": [],
        "params":
          [ { "name": "event",
              "type": "wix-marketing-backend.Events.CouponDeletedEvent",
              "doc": "Information about a deleted coupon." } ],
        "ret":
          { "type": "void" },
        "locations":
          [ { "lineno": 113,
              "filename": "events.js" } ],
        "docs":
          { "summary": "An event that is triggered when a coupon is deleted.",
            "description":
              [ "The `onCouponDeleted()` event handler runs when a coupon is deleted.",
                "",
                "> **Note:** Backend events don't work when previewing your site." ],
            "links":
              [ "[`deleteCoupon()`](https://www.wix.com/corvid/reference/wix-marketing-backend/coupons-obj/deletecoupon)" ],
            "examples":
              [ { "title": "An event when a coupon is deleted",
                  "body":
                    [ "// Place this code in the events.js file",
                      "// of your site's Backend section.",
                      "",
                      "export function wixMarketing_onCouponDeleted(event) {",
                      "  const deletedCouponId = event.metadata.entityId;",
                      "}",
                      "",
                      "/* Full event object",
                      " *",
                      " *  {",
                      " *    \"metadata\": {",
                      " *      \"id\": \"0c279cd0-3db2-4e5c-afb5-9b1346bf3ccc\",",
                      " *      \"entityId\": \"03a35393-7835-44b0-af53-6019a484b48b\",",
                      " *      \"eventTime\": \"2021-01-17T12:01:46.597758Z\",",
                      " *      \"triggeredByAnonymizeRequest\": false",
                      " *    }",
                      " *  }",
                      " *",
                      " */" ],
                  "extra":
                    {  } } ],
            "extra":
              {  } },
        "extra":
          {  } },
      { "name": "onCouponUpdated",
        "labels": [],
        "nameParams": [],
        "params":
          [ { "name": "event",
              "type": "wix-marketing-backend.Events.CouponEvent",
              "doc": "Information about an updated coupon." } ],
        "ret":
          { "type": "void" },
        "locations":
          [ { "lineno": 82,
              "filename": "events.js" } ],
        "docs":
          { "summary": "An event that is triggered when a coupon is updated.",
            "description":
              [ "The `onCouponUpdated()` event handler runs when a coupon is updated.",
                "",
                "> **Note:** Backend events don't work when previewing your site." ],
            "links":
              [ "[`updateCouponFields()`](https://www.wix.com/corvid/reference/wix-marketing-backend/coupons-obj/updatecouponfields)" ],
            "examples":
              [ { "title": "An event when a coupon is updated to only apply to a specific product",
                  "body":
                    [ "// Place this code in the events.js file",
                      "// of your site's Backend section.",
                      "",
                      "export function wixMarketing_onCouponUpdated(event) {",
                      "  const updatedCouponId = event.entity._id;",
                      "  const updatedCouponCode = event.entity.code;",
                      "  const productIdCouponAppliesTo = event.entity.scope.group.entityId;",
                      "}",
                      "",
                      "/* Full event object",
                      " *",
                      " *  {",
                      " *    \"metadata\": {",
                      " *      \"id\": \"77aff6e5-974c-49f0-adc1-255363cd5c55\",",
                      " *      \"entityId\": \"03a35393-7835-44b0-af53-6019a484b48b\",",
                      " *      \"eventTime\": \"2021-01-17T11:49:44.606828Z\",",
                      " *      \"triggeredByAnonymizeRequest\": false",
                      " *    },",
                      " *    \"entity\": {",
                      " *      \"_id\": \"03a35393-7835-44b0-af53-6019a484b48b\",",
                      " *      \"name\": \"Summer Sale 10% off\",",
                      " *      \"code\": \"SummerSale\",",
                      " *      \"startTime\": \"Wed Jun 30 2021 21:00:00 GMT+0000 (Coordinated Universal Time)\",",
                      " *      \"expirationTime\": \"Tue Aug 31 2021 20:59:59 GMT+0000 (Coordinated Universal Time)\",",
                      " *      \"limitPerCustomer\": 1,",
                      " *      \"active\": true,",
                      " *      \"scope\": {",
                      " *        \"namespace\": \"stores\",",
                      " *        \"group\": {",
                      " *          \"name\": \"product\",",
                      " *          \"entityId\": \"5376f9ec-b92e-efa9-e4a1-f4f480aa0d3a\"",
                      " *        }",
                      " *      },",
                      " *      \"_dateCreated\": \"Sun Jan 17 2021 11:40:56 GMT+0000 (Coordinated Universal Time)\",",
                      " *      \"expired\": false,",
                      " *      \"displayData\": {",
                      " *        \"name\": \"Indonesian Blend\",",
                      " *        \"formattedPrice\": \"$35.00\",",
                      " *        \"mediaItem\": \"https://static.wixstatic.com/media/nsplsh_316b6449475f3235386255~mv2_d_2977_3951_s_4_2.jpg/v1/fit/w_2977,h_3951,q_90/file.jpg\"",
                      " *      },",
                      " *      \"limitedToOneItem\": false,",
                      " *      \"type\": \"PercentOff\",",
                      " *      \"percentOffRate\": 10",
                      " *    }",
                      " *  }",
                      " *",
                      " */" ],
                  "extra":
                    {  } } ],
            "extra":
              {  } },
        "extra":
          {  } } ],
  "callbacks": [],
  "messages":
    [ { "name": "CouponAppliedEvent",
        "locations":
          [ { "lineno": 148,
              "filename": "events.js" } ],
        "docs":
          { "summary": "An object representing a custom coupon event.",
            "links": [],
            "examples": [],
            "extra":
              {  } },
        "members":
          [ { "name": "metadata",
              "type": "wix-marketing-backend.Events.Metadata",
              "doc": "Event metadata." },
            { "name": "data",
              "type": "wix-marketing-backend.Events.Data",
              "doc": "Event data." } ],
        "extra":
          {  },
        "labels": [] },
      { "name": "CouponAppliedEventBody",
        "locations":
          [ { "lineno": 50,
              "filename": "events.js" } ],
        "docs":
          { "links": [],
            "examples": [],
            "extra":
              {  } },
        "members":
          [ { "name": "coupon",
              "type": "wix-marketing-backend.Coupons.Coupon",
              "doc": "Applied coupon information." },
            { "name": "wixAppId",
              "type": "string",
              "doc": "ID of app that applied the coupon (Stores, Bookings, Events)." },
            { "name": "wixAppOrderId",
              "type": "string",
              "doc": "ID of the entity that the coupon was applied to (orderId, bookingId, etc.)." } ],
        "extra":
          {  },
        "labels":
          [ "removed" ] },
      { "name": "CouponDeletedEvent",
        "locations":
          [ { "lineno": 128,
              "filename": "events.js" } ],
        "docs":
          { "summary": "An object representing a custom coupon event.",
            "links": [],
            "examples": [],
            "extra":
              {  } },
        "members":
          [ { "name": "metadata",
              "type": "wix-marketing-backend.Events.Metadata",
              "doc": "Event metadata." } ],
        "extra":
          {  },
        "labels": [] },
      { "name": "CouponEvent",
        "locations":
          [ { "lineno": 97,
              "filename": "events.js" } ],
        "docs":
          { "summary": "An object representing a coupon event.",
            "links": [],
            "examples": [],
            "extra":
              {  } },
        "members":
          [ { "name": "metadata",
              "type": "wix-marketing-backend.Events.Metadata",
              "doc": "Event metadata." },
            { "name": "entity",
              "type": "wix-marketing-backend.Coupons.Coupon",
              "doc": "Coupon information." } ],
        "extra":
          {  },
        "labels": [] },
      { "name": "Data",
        "locations":
          [ { "lineno": 155,
              "filename": "events.js" } ],
        "docs":
          { "summary": "An object representing a custom event's data.",
            "links": [],
            "examples": [],
            "extra":
              {  } },
        "members":
          [ { "name": "coupon",
              "type": "wix-marketing-backend.Coupons.Coupon",
              "doc": "Applied coupon information." },
            { "name": "wixAppOrderId",
              "type": "string",
              "doc": "ID of the entity that the coupon was applied to (orderId, bookingId, etc.)." },
            { "name": "wixAppId",
              "type": "string",
              "doc": "ID of the Wix app that applied the coupon.\n + Wix Stores: `215238eb-22a5-4c36-9e7b-e7c08025e04e`\n + Wix Bookings: `13d21c63-b5ec-5912-8397-c3a5ddb27a97`\n + Wix Events: `140603ad-af8d-84a5-2c80-a0f60cb47351`" } ],
        "extra":
          {  },
        "labels": [] },
      { "name": "Metadata",
        "locations":
          [ { "lineno": 104,
              "filename": "events.js" } ],
        "docs":
          { "summary": "An object representing a coupon.",
            "links": [],
            "examples": [],
            "extra":
              {  } },
        "members":
          [ { "name": "id",
              "type": "string",
              "doc": "Event ID." },
            { "name": "entityId",
              "type": "string",
              "doc": "Coupon ID associated with this event." },
            { "name": "eventTime",
              "type": "string",
              "doc": "Event timestamp." },
            { "name": "triggeredByAnonymizeRequest",
              "type": "boolean",
              "doc": "Whether this event was triggered as a result of a privacy regulation application (for example, [GDPR](https://support.wix.com/en/article/gdpr-frequently-asked-questions)). For advanced users." } ],
        "extra":
          {  },
        "labels": [] } ],
  "extra":
    {  } }
