{ "name": "Orders",
  "memberOf": "wix-pricing-plans",
  "mixes": [],
  "labels":
    [ "new" ],
  "location":
    { "lineno": 193,
      "filename": "pricing-plans.js" },
  "docs":
    { "summary": "The Pricing Plans Orders API contains functionality for managing\n your site's pricing plan [orders](https://support.wix.com/en/article/pricing-plans-an-overview).",
      "description":
        [ "Use the Pricing Plans Orders API to manage orders for your pricing plans. The Pricing Plans ",
          " Orders API provides functionality for managing pricing plan orders created ",
          " in the Wix Pricing Plans app or using this Wix Pricing Plans API.",
          "",
          "",
          " > **Note:**",
          " > The Pricing Plans APIs replace the deprecated Paid Plans APIs.",
          " > The deprecated APIs will continue to work, but they will not receive updates. To keep any existing code compatible with future changes, see the",
          " > migration instructions for each function.",
          "",
          " ### Setup",
          "",
          " To use APIs to manage your plan orders, first set up your site to:",
          "",
          " + Accept payments as described in [About Accepting Payments](https://support.wix.com/en/article/about-accepting-payments).",
          "",
          " + Offer membership plans as described in [About Pricing Plans](https://support.wix.com/en/article/about-pricing-plans). When setting up your site to accept pricing plans, ",
          "   define the plans you want to offer [using the Dashboard](https://support.wix.com/en/article/creating-a-plan-in-pricing-plans) or",
          "   [using the Pricing Plan APIs](wix-pricing-plans/introduction).",
          "",
          "",
          " ### Managing Orders",
          "",
          " Members can check out pricing plans in 2 ways:",
          "",
          " + **Online**. Members order and pay for their plans",
          "   on your site without manual intervention. This can also be done",
          "   in [backend code](wix-pricing-plans-backend/checkout/createOnlineOrder).",
          "",
          " + **Offline**. Members place their order by phone, text, or email. This can only be done",
          "   in [backend code](wix-pricing-plans-backend/checkout/createOfflineOrder).",
          "",
          " Use the Orders API to manage online pricing plan orders. You can: ",
          "",
          " + List orders for the currently logged-in member.",
          " + Allow members to request cancellation of their own orders. ",
          " ",
          "",
          "",
          " ### Plans and Subscriptions",
          " ",
          " ",
          " Actions related to basic pricing plan management are available from the [Pricing Plans](https://www.wix.com/my-account/site-selector/?buttonText=Select%20Site&title=Select%20a%20Site&autoSelectOnSingleSite=true&actionUrl=https:%2F%2Fwww.wix.com%2Fdashboard%2F%7B%7BmetaSiteId%7D%7D%2Fmembership%3FreferralInfo%3Dvelo-docs)",
          " page in the Dashboard. These actions correspond to the functions available in the [Pricing Plans APIs](wix-pricing-plans/introduction).",
          "",
          " Every pricing plan order corresponds to a Wix subscription, including orders for single payment plans. You can see all orders from your site's",
          " [Subscriptions](https://www.wix.com/my-account/site-selector/?buttonText=Select%20Site&title=Select%20a%20Site&autoSelectOnSingleSite=true&actionUrl=https:%2F%2Fwww.wix.com%2Fdashboard%2F%7B%7BmetaSiteId%7D%7D%2Fsubscriptions%3FreferralInfo%3Dvelo-docs)",
          " page in the Dashboard. Actions available on this page correspond to the functions available in the [Orders APIs](wix-pricing-plans/orders/introduction) and the [Checkout APIs](wix-pricing-plans/checkout/introduction).",
          "",
          "",
          " > **Notes**: ",
          " >",
          " > + Wix pricing plans are 1 type of Wix subscriptions available from the Subscriptions page. For example, the Subscriptions page also includes Wix Stores subscriptions and Wix invoice subscriptions.",
          " >",
          " > + Pricing plans can be 1 of 3 different pricing models: `singlePaymentForDuration`, `singlePaymentUnlimited`, and `subscription.` Orders for all pricing plan models are displayed ",
          "     on the Subscriptions page (not just `subscription`).  ",
          "",
          "",
          " ### Roles and Permissions",
          "",
          " The current user needs to be logged in to perform ",
          " plan order functions, such as [`listCurrentMemberOrders()`](wix-pricing-plans/orders/listCurrentMemberOrders), [`requestCurrentMemberOrderCancellation()`](wix-pricing-plans/orders/requestCurrentMemberOrderCancellation), and so on. ",
          "",
          "",
          " ### Importing the APIs",
          "",
          " To use the Orders API, import `orders` from the `wix-pricing-plans` module.",
          "",
          "   ```javascript",
          "   import {orders} from 'wix-pricing-plans';",
          "   ```" ],
      "links": [],
      "examples": [],
      "extra":
        {  } },
  "properties": [],
  "operations":
    [ { "name": "listCurrentMemberOrders",
        "labels": [],
        "nameParams": [],
        "params":
          [ { "name": "filters",
              "type": "wix-pricing-plans-backend.Orders.CurrentMemberFilterOptions",
              "doc": "Filter options for limiting which orders are listed.",
              "optional": true },
            { "name": "sorting",
              "type": "wix-pricing-plans-backend.Orders.SortingOptions",
              "doc": "Sorting options, such as by which property and in which direction.",
              "optional": true },
            { "name": "paging",
              "type": "wix-pricing-plans-backend.Orders.PaginationOptions",
              "doc": "Pagination options, such as how many results are listed at a time.",
              "optional": true } ],
        "ret":
          { "type":
              { "name": "Promise",
                "typeParams":
                  [ { "name": "Array",
                      "typeParams":
                        [ "wix-pricing-plans-backend.Orders.Order" ] } ] },
            "doc": "Fulfilled - An array of order objects for the currently logged-in member.\nRejected - Error message." },
        "locations":
          [ { "lineno": 626,
              "filename": "pricing-plans.js" } ],
        "docs":
          { "summary": "Lists the orders for the currently logged-in member.",
            "description":
              [ "The `listsCurrentMemberOrders()` function returns a Promise that resolves to an ",
                " array of the non-draft orders for the currently logged-in member.",
                "",
                " > **Notes:**",
                " > + The pricing plan `listCurrentMemberOrders()` function ",
                " >     replaces the deprecated paid plans `getCurrentMemberOrders()` function.",
                " >     The deprecated function will continue to work, but will not receive updates.",
                " >     To keep any existing code compatible with future changes, see the",
                " >     [migration instructions](wix-paid-plans/getcurrentmemberorders#migration-instructions).",
                " >   ",
                " > + To work with the Pricing Plans API, you need to publish your site." ],
            "links":
              [ "[listOrders(Â )](wix-pricing-plans-backend.Orders/listOrders)" ],
            "examples":
              [ { "title": "List the current member's orders on button click",
                  "body":
                    [ "import { orders } from 'wix-pricing-plans'; ",
                      "",
                      "$w('#listMyOrdersButton').onClick((event) => {",
                      "  orders.listCurrentMemberOrders()",
                      "    .then((myOrderList) => {",
                      "      const firstOrder = myOrderList[0];",
                      "      const firstOrderPlan = myOrderList[0].planName;",
                      "      return myOrderList;",
                      "    })",
                      "    .catch((err) => {",
                      "        console.error(err);",
                      "    });",
                      "  });",
                      "",
                      "",
                      "/* In this case, a `myOrderList` array of two order items:",
                      " * [",
                      " *   {",
                      " *     \"_id\": \"f0d30ec6-8804-4f0a-b444-de3e855fa6fb\",",
                      " *     \"planId\": \"7251b9e9-3852-4e9f-958e-af630f039802\",",
                      " *     \"subscriptionId\": \"6df16bbb-c90e-4a2b-b33f-969aa0d75ea6\",",
                      " *     \"buyer\": {",
                      " *       \"memberId\": \"4c47c608-cfa8-4037-93ac-738f09560ed3\",",
                      " *       \"contactId\": \"4c47c608-cfa8-4037-93ac-738f09560ed3\"",
                      " *     },",
                      " *     \"priceDetails\": {",
                      " *       \"subtotal\": \"0\",",
                      " *       \"total\": \"0\",",
                      " *       \"planPrice\": \"0\",",
                      " *       \"currency\": \"USD\",",
                      " *       \"singlePaymentUnlimited\": true",
                      " *     },",
                      " *     \"type\": \"ONLINE\",",
                      " *     \"status\": \"ACTIVE\",",
                      " *     \"lastPaymentStatus\": \"NOT_APPLICABLE\",",
                      " *     \"startDate\": \"2021-10-17T11:18:58.256Z\",",
                      " *     \"pausePeriods\": [],",
                      " *     \"planName\": \"Family Cooking\",",
                      " *     \"planDescription\": \"Weekly delivery of home cooking recipes and time-saving tips\",",
                      " *     \"_createdDate\": \"2021-10-17T11:18:58.256Z\",",
                      " *     \"_updatedDate\": \"2021-10-17T11:18:58.454Z\"",
                      " *   },",
                      " *   {",
                      " *     \"_id\": \"023d3a89-5bcd-40f9-ba30-79162ac2eae3\",",
                      " *     \"planId\": \"38b3021a-8b43-4a31-98cc-4a05b522b7d3\",",
                      " *     \"subscriptionId\": \"7d3a43c3-c1df-477c-9353-4a827c393020\",",
                      " *     \"wixPayOrderId\": \"b025fb5a-dc18-420c-b6b6-77c65255acea\",",
                      " *     \"buyer\": {",
                      " *       \"memberId\": \"4c47c608-cfa8-4037-93ac-738f09560ed3\",",
                      " *       \"contactId\": \"4c47c608-cfa8-4037-93ac-738f09560ed3\"",
                      " *     },",
                      " *     \"priceDetails\": {",
                      " *       \"subtotal\": \"10\",",
                      " *       \"total\": \"10\",",
                      " *       \"planPrice\": \"10\",",
                      " *       \"currency\": \"USD\",",
                      " *       \"subscription\": {",
                      " *         \"cycleDuration\": {",
                      " *           \"count\": 1,",
                      " *           \"unit\": \"MONTH\"",
                      " *         },",
                      " *         \"cycleCount\": 12",
                      " *       },",
                      " *       \"freeTrialDays\": 30",
                      " *     },",
                      " *     \"type\": \"OFFLINE\",",
                      " *     \"status\": \"ACTIVE\",",
                      " *     \"autoRenewCanceled\": false,",
                      " *     \"lastPaymentStatus\": \"UNPAID\",",
                      " *     \"startDate\": \"2021-08-26T15:23:03.374Z\",",
                      " *     \"endDate\": \"2022-09-25T15:23:03.374Z\",",
                      " *     \"pausePeriods\": [],",
                      " *     \"planName\": \"Diabetic Cooking\",",
                      " *     \"planDescription\": \"Special recipes for those with diabetes.\",",
                      " *     \"_createdDate\": \"2021-08-26T15:23:03.374Z\",",
                      " *     \"_updatedDate\": \"2021-08-26T15:23:03.948Z\"",
                      " *    }",
                      " *  ]",
                      " */" ],
                  "extra":
                    {  } },
                { "title": "Sort and list the current member's orders for given plan and order statuses",
                  "body":
                    [ "import { orders } from 'wix-pricing-plans'; ",
                      "",
                      "",
                      "/* Sample filters object: ",
                      " * {",
                      " *   planIds: ['aef93bb6-aaaa-4965-966e-bd68dd2a1cc2', '7251b9e9-3852-4e9f-958e-af630f039802'],",
                      " *   orderStatuses: ['PAUSED', 'CANCELED']",
                      " * }",
                      " */",
                      "",
                      "/* Sample sorting object: ",
                      " * {",
                      " *   fieldName: '_createdDate',",
                      " *   order: 'DESC'",
                      " * }",
                      " */",
                      "",
                      "/* Sample paging object: ",
                      " * {",
                      " *   limit: 3,",
                      " *   skip: 1",
                      " * }",
                      " */",
                      "",
                      "",
                      "$w('#listMyOrdersButton').onClick((event) => {",
                      "  orders.listCurrentMemberOrders(filters, sorting, paging)",
                      "    .then((myOrderList) => {",
                      "      const firstOrder = myOrderList[0];",
                      "      const firstOrderPlan = myOrderList[0].planName;",
                      "      return myOrderList;",
                      "    })",
                      "    .catch((err) => {",
                      "        console.error(err);",
                      "    });",
                      "  });",
                      "",
                      "",
                      "/* Promise resolves to: ",
                      " * [",
                      " *   {",
                      " *     \"_id\": \"de381e02-604b-417a-beb4-31f4f237bd58\",",
                      " *     \"planId\": \"7251b9e9-3852-4e9f-958e-af630f039802\",",
                      " *     \"subscriptionId\": \"24797b1e-c915-4f07-aedf-7e035c74cadd\",",
                      " *     \"buyer\": {",
                      " *       \"memberId\": \"4c47c608-cfa8-4037-93ac-738f09560ed3\",",
                      " *       \"contactId\": \"4c47c608-cfa8-4037-93ac-738f09560ed3\"",
                      " *     },",
                      " *     \"priceDetails\": {",
                      " *       \"subtotal\": \"0\",",
                      " *       \"total\": \"0\",",
                      " *       \"planPrice\": \"0\",",
                      " *       \"currency\": \"USD\",",
                      " *       \"singlePaymentUnlimited\": true",
                      " *     },",
                      " *     \"type\": \"ONLINE\",",
                      " *     \"status\": \"CANCELED\",",
                      " *     \"cancellation\": {",
                      " *       \"cause\": \"OWNER_ACTION\",",
                      " *       \"effectiveAt\": \"IMMEDIATELY\"",
                      " *     },",
                      " *     \"lastPaymentStatus\": \"NOT_APPLICABLE\",",
                      " *     \"startDate\": \"Sun Oct 31 2021 13:00:00 GMT+0200 (Israel Standard Time)\",",
                      " *     \"endDate\": \"Sun Oct 17 2021 11:02:01 GMT+0300 (Israel Daylight Time)\",",
                      " *     \"pausePeriods\": [],",
                      " *     \"planName\": \"Family Cooking\",",
                      " *     \"planDescription\": \"Weekly delivery of home cooking recipes and time-saving tips\",",
                      " *     \"_createdDate\": \"Thu Sep 02 2021 15:09:46 GMT+0300 (Israel Daylight Time)\",",
                      " *     \"_updatedDate\": \"Sun Oct 17 2021 11:02:01 GMT+0300 (Israel Daylight Time)\"",
                      " *   },",
                      " *   {",
                      " *     \"_id\": \"06610ca6-ff9d-4596-952a-c35e723659f5\",",
                      " *     \"planId\": \"7251b9e9-3852-4e9f-958e-af630f039802\",",
                      " *     \"subscriptionId\": \"28330017-4b1b-4364-b9be-b5b37d58c178\",",
                      " *     \"buyer\": {",
                      " *       \"memberId\": \"4c47c608-cfa8-4037-93ac-738f09560ed3\",",
                      " *       \"contactId\": \"4c47c608-cfa8-4037-93ac-738f09560ed3\"",
                      " *     },",
                      " *     \"priceDetails\": {",
                      " *       \"subtotal\": \"0\",",
                      " *       \"total\": \"0\",",
                      " *       \"planPrice\": \"0\",",
                      " *       \"currency\": \"USD\",",
                      " *       \"singlePaymentUnlimited\": true",
                      " *     },",
                      " *     \"type\": \"ONLINE\",",
                      " *     \"status\": \"PAUSED\",",
                      " *     \"lastPaymentStatus\": \"NOT_APPLICABLE\",",
                      " *     \"startDate\": \"Sun Oct 31 2021 13:00:00 GMT+0200 (Israel Standard Time)\",",
                      " *     \"pausePeriods\": [",
                      " *       {",
                      " *         \"status\": \"ACTIVE\",",
                      " *         \"pauseDate\": \"Sun Oct 17 2021 11:02:21 GMT+0300 (Israel Daylight Time)\"",
                      " *       }",
                      " *     ],",
                      " *     \"planName\": \"Family Cooking\",",
                      " *     \"planDescription\": \"Weekly delivery of home cooking recipes and time-saving tips\",",
                      " *     \"_createdDate\": \"Thu Sep 02 2021 15:08:56 GMT+0300 (Israel Daylight Time)\",",
                      " *     \"_updatedDate\": \"Sun Oct 17 2021 11:02:21 GMT+0300 (Israel Daylight Time)\"",
                      " *   },",
                      " *   {",
                      " *     \"_id\": \"38f0acac-d4b9-44bf-b246-7af74e2a02ae\",",
                      " *     \"planId\": \"aef93bb6-aaaa-4965-966e-bd68dd2a1cc2\",",
                      " *     \"subscriptionId\": \"20f84f97-1394-440c-b64b-111d7d4f0dfb\",",
                      " *     \"wixPayOrderId\": \"7fb1288d-a619-42b2-ae72-d65927413a9b\",",
                      " *     \"buyer\": {",
                      " *       \"memberId\": \"4c47c608-cfa8-4037-93ac-738f09560ed3\",",
                      " *       \"contactId\": \"4c47c608-cfa8-4037-93ac-738f09560ed3\"",
                      " *     },",
                      " *     \"priceDetails\": {",
                      " *       \"subtotal\": \"2\",",
                      " *       \"total\": \"2\",",
                      " *       \"planPrice\": \"2\",",
                      " *       \"currency\": \"USD\",",
                      " *       \"subscription\": {",
                      " *         \"cycleDuration\": {",
                      " *           \"count\": 1,",
                      " *           \"unit\": \"WEEK\"",
                      " *         },",
                      " *         \"cycleCount\": 26",
                      " *       }",
                      " *     },",
                      " *     \"type\": \"ONLINE\",",
                      " *     \"status\": \"CANCELED\",",
                      " *     \"autoRenewCanceled\": true,",
                      " *     \"cancellation\": {",
                      " *       \"cause\": \"PAYMENT_FAILURE\",",
                      " *       \"effectiveAt\": \"IMMEDIATELY\"",
                      " *     },",
                      " *     \"lastPaymentStatus\": \"FAILED\",",
                      " *     \"startDate\": \"Thu Oct 21 2021 14:00:00 GMT+0300 (Israel Daylight Time)\",",
                      " *     \"endDate\": \"Thu Oct 28 2021 20:40:01 GMT+0300 (Israel Daylight Time)\",",
                      " *     \"pausePeriods\": [],",
                      " *     \"planName\": \"Cooking for Kids\",",
                      " *     \"planDescription\": \"Get easy-to-make recipes that kids can prepare on their own!\",",
                      " *     \"_createdDate\": \"Fri Aug 27 2021 19:04:45 GMT+0300 (Israel Daylight Time)\",",
                      " *     \"_updatedDate\": \"Thu Oct 28 2021 20:40:01 GMT+0300 (Israel Daylight Time)\"",
                      " *   }",
                      " * ]",
                      " */" ],
                  "extra":
                    {  } },
                { "title": "List the current member's orders in a table",
                  "body":
                    [ "import { orders } from 'wix-pricing-plans'; ",
                      "",
                      "// The \"columns\" constant is used to set",
                      "// the properties of the table columns.",
                      "",
                      "const columns =  [",
                      "  {",
                      "    id: 'orderID',",
                      "    dataPath: 'id',",
                      "    label: 'Order',",
                      "    width: 15,",
                      "    visible: true,",
                      "    type: 'string'",
                      "    },",
                      "  {",
                      "    id: 'planName',",
                      "    dataPath: 'planName',",
                      "    label: 'Plan',",
                      "    width: 15,",
                      "    visible: true,",
                      "    type: 'string'",
                      "  },",
                      "  {",
                      "    id: 'planID',",
                      "    dataPath: 'planId',",
                      "    label: 'Plan ID',",
                      "    width: 15,",
                      "    visible: true,",
                      "    type: 'string'",
                      "  },",
                      "  {",
                      "    id: 'subID',",
                      "    dataPath: 'subscriptionId',",
                      "    label: 'Subscription ID',",
                      "    width: 15,",
                      "    visible: true,",
                      "    type: 'string'",
                      "  },",
                      "  {",
                      "    id: 'wixPayID',",
                      "    dataPath: 'wixPayOrderId',",
                      "    label: 'Wix Pay ID',",
                      "    width: 15,",
                      "    visible: true,",
                      "    type: 'string'",
                      "  },",
                      "  {",
                      "    id: 'type',",
                      "    dataPath: 'orderType',",
                      "    label: 'Type',",
                      "    width: 8,",
                      "    visible: true,",
                      "    type: 'string'",
                      "  },",
                      "  {",
                      "    id: 'status',",
                      "    dataPath: 'status',",
                      "    label: 'Status',",
                      "    width: 8,",
                      "    visible: true,",
                      "    type: 'string'",
                      "  }",
                      "];",
                      "",
                      "$w('#listMyOrdersButton').onClick((event) => {",
                      "  ",
                      "\t$w('#myOrderTable').rows = [];",
                      "\t$w('#myOrderTable').columns = columns;",
                      "",
                      "  orders.listCurrentMemberOrders()",
                      "    .then((myOrderList) => {",
                      "      $w('#myOrderTable').rows = myOrderList;",
                      "    })",
                      "    .catch((err) => {",
                      "        console.error(err);",
                      "    });",
                      "});" ],
                  "extra":
                    {  } } ],
            "extra":
              {  } },
        "extra":
          {  } },
      { "name": "requestCurrentMemberOrderCancellation",
        "labels": [],
        "nameParams": [],
        "params":
          [ { "name": "orderId",
              "type": "string",
              "doc": "The order ID of the order whose cancellation is requested." },
            { "name": "effectiveAt",
              "type": "string",
              "doc": "When the cancellation should take effect.\nOne of:\n + `\"IMMEDIATELY\"`. The cancellation occurs immediately and the buyer cannot use the plan at this point.\n + `\"NEXT_PAYMENT_DATE\"`. The cancellation occurs at the next payment date. The buyer can continue to use the plan until that date." } ],
        "ret":
          { "type":
              { "name": "Promise",
                "typeParams":
                  [ "void" ] },
            "doc": "Fulfilled - When the order cancellation is requested." },
        "locations":
          [ { "lineno": 568,
              "filename": "pricing-plans.js" } ],
        "docs":
          { "summary": "Requests the cancellation of a specific order of a plan for the currently logged-in member.",
            "description":
              [ "The `requestCurrentMemberOrderCancellation()` function requests the cancellation of an order,",
                " after verifying that the site member is logged in.",
                "",
                " This function does not immediately cancel the order. The cancellation request is initiated ",
                " and the `status` of the order is updated to `\"PENDING_CANCELLATION\"`. When the cancellation ",
                " is completed, the order status is updated to `\"CANCELED\"`.",
                "",
                " Keep in mind that a site member can order several subscriptions of the same plan. ",
                " This API does not cancel the plan and remove all corresponding subscriptions. ",
                " This API removes only the one specified order of the plan.",
                " ",
                " If a plan's [Allow Plan Cancellation](https://support.wix.com/en/article/pricing-plans-allowing-clients-to-cancel-plans) ",
                " setting is disabled and the currently logged-in site member tries to cancel an order for the plan using the `requestCurrentMemberOrderCancellation()` function,",
                " an error is thrown. ",
                "",
                "",
                " > **Notes**:",
                " > + The pricing plan `requestCurrentMemberOrderCancellation()` function",
                " >     replaces the deprecated paid plans `cancelOrder()` function.",
                " >     The deprecated function will continue to work, but will not receive updates.",
                " >     To keep any existing code compatible with future changes, see the",
                " >     [`cancelOrder()` migration instructions](wix-paid-plans/cancelorder#migration-instructions).",
                " >     ",
                " > + To work with the Pricing Plans API, you need to publish your site." ],
            "links": [],
            "examples":
              [ { "title": "Request cancellation of an order on button click",
                  "body":
                    [ "import { orders } from 'wix-pricing-plans'; ",
                      "",
                      "const orderId = // Get the order ID of the subscription to cancel",
                      "const effectiveAt = 'NEXT_PAYMENT_DATE';",
                      "",
                      "$w('#cancelMyOrderButton').onClick((event) => {",
                      " orders.requestCurrentMemberOrderCancellation(orderId, effectiveAt)",
                      "  .then (() => {",
                      "    console.log('Order cancellation requested');",
                      "  })",
                      "  .catch((err) => {",
                      "    console.error(err);",
                      "  });",
                      "});" ],
                  "extra":
                    {  } },
                { "title": "A full cancel order request scenario",
                  "body":
                    [ "import { orders } from 'wix-pricing-plans';  ",
                      "import wixData from 'wix-data';             ",
                      "import wixUsers from 'wix-users';           ",
                      "import wixWindow from 'wix-window';         ",
                      "",
                      "$w.onReady(function () {",
                      "",
                      "  $w('#subscriptionDataset').onReady( () => {",
                      "",
                      "    // Get the order ID for the subscription to cancel",
                      "    const subscription = $w('#subscriptionDataset').getCurrentItem();   ",
                      "    const orderId = subscription.orderId; ",
                      "",
                      "    $w('cancelButton').onClick((event) => {",
                      "",
                      "      // Cancel the specific subscription of the plan immediately",
                      "      orders.requestCurrentMemberOrderCancellation(orderId, \"IMMEDIATELY\")",
                      "        .then(() => {",
                      "",
                      "          // Let user know that cancellation succeeded",
                      "          wixWindow.openLightbox('orderCanceled');",
                      "",
                      "          // Get details for updating status of existing subscription",
                      "          const user = wixUsers.currentUser;   ",
                      "          const toUpdate = {",
                      "            _id:         subscription._id,",
                      "            planName:    subscription.planName,",
                      "            planId:      subscription.planId,",
                      "            orderId:     subscription.orderId,",
                      "            memberId:    user.id,",
                      "            dateCreated: subscription.dateCreated,",
                      "            canceled:    true,            // Set cancellation to true",
                      "            dateUpdated: Date().toString()",
                      "          };",
                      "    ",
                      "          // Update subscription in collection to show the subscription is canceled",
                      "          wixData.update('Subscriptions', toUpdate);",
                      "        })",
                      "",
                      "        // Let user know if cancellation failed",
                      "        .catch((err) => {",
                      "          wixWindow.openLightbox('cancelFailed');",
                      "        });",
                      "      });",
                      "    });",
                      "  });" ],
                  "extra":
                    { "description": "This example demonstrates a more robust scenario for requesting the cancellation of a pricing plan order, \n including updates to a collection.\n\n In the interest of simplicity the code does not deal with display considerations or validations\n that would normally be required to make sure users perform the flow as\n intended.\n\n Customized elements include:\n\n + A cancelButton button that the site member clicks to cancel an order of a plan.\n + A Subscriptions collection. This custom collection contains all plan orders purchased by the site member and each subscription's status.\n + A subscriptionDataset dataset that connects the page to the Subscriptions collection.\n + Two lightboxes, orderCanceled and cancelFailed that notify the site member if a subscription is cancelled." } } ],
            "extra":
              {  } },
        "extra":
          {  } } ],
  "callbacks": [],
  "messages": [],
  "extra":
    {  } }