{ "name": "CurrentMember",
  "memberOf": "wix-members-backend",
  "mixes": [],
  "labels":
    [ "changed" ],
  "location":
    { "lineno": 16,
      "filename": "index.js" },
  "docs":
    { "summary": "The CurrentMember API contains functionality for viewing and managing site members from backend code.",
      "description":
        [ "To use the CurrentMember API, import `{currentMember}` from the `wix-members-backend` module:",
          "",
          "```javascript",
          "import { currentMember } from 'wix-members-backend';",
          "```",
          "> **Note:**",
          "> The APIs in `CurrentMember` are only partially functional when previewing your site. View a published version of your site to see their complete functionality." ],
      "links": [],
      "examples": [],
      "extra":
        {  } },
  "properties": [],
  "operations":
    [ { "name": "getMember",
        "labels":
          [ "changed" ],
        "nameParams": [],
        "params":
          [ { "name": "options",
              "type": "wix-members-backend.Members.FieldsetOptions",
              "doc": "Fieldset options.",
              "optional": true } ],
        "ret":
          { "type":
              { "name": "Promise",
                "typeParams":
                  [ "wix-members-backend.Members.Member" ] },
            "doc": "Fulfilled - Updated member." },
        "locations":
          [ { "lineno": 1,
              "filename": "getMember.js" } ],
        "docs":
          { "summary": "Retrieves the currently logged-in member.",
            "description":
              [ "<!--ONLY:VELO-->",
                "The `getMember()` function returns a Promise that resolves",
                "to the currently logged-in member.",
                "",
                "> **Notes:**",
                "> - The APIs in `CurrentMember` are only partially functional when previewing your site. View a published version of your site to see their complete functionality.",
                "> - This function replaces the deprecated `wix-users-backend.currentUser`. The deprecated object and its methods will continue to work, but they will not receive updates. To keep any existing code compatible with future changes, see the [migration instructions](wix-users-backend/currentuser#migration-instructions).",
                "<!--END:ONLY:VELO-->" ],
            "links": [],
            "examples":
              [ { "title": "Get the currently logged-in member",
                  "body":
                    [ "import { currentMember } from 'wix-members-backend';",
                      "",
                      "// Sample options value:",
                      "// {",
                      "//   fieldsets: [ 'FULL' ]",
                      "// }",
                      "",
                      "export function myGetCurrentMemberFunction(options) {",
                      "  return currentMember.getMember(options)",
                      "    .then((member) => {",
                      "      const memberId = member._id;",
                      "      const fullName = `${member.contactDetails.firstName} ${member.contactDetails.lastName}`;",
                      "      const memberProfilePage = `https://yoursite.com/profile/${member.profile.slug}/profile`;",
                      "",
                      "      return member;",
                      "    })",
                      "    .catch((error) => {",
                      "      console.error(error);",
                      "    })",
                      "}",
                      "",
                      "/* Promise resolves to:",
                      " * {",
                      " *   \"_id\": \"f32cbc51-a331-442b-86c2-2c664613e8b9\",",
                      " *   \"_createdDate\": \"2021-08-02T23:14:42.000Z\",",
                      " *   \"_updatedDate\": \"2021-08-02T23:14:58.345Z\",",
                      " *   \"lastLoginDate\": \"2021-08-04T05:10:21.000Z\",",
                      " *   \"loginEmail\": \"claude.morales@example.com\",",
                      " *   \"contactId\": \"f32cbc51-a331-442b-86c2-2c664613e8b9\",",
                      " *   \"status\": \"APPROVED\",",
                      " *   \"privacyStatus\": \"PUBLIC\",",
                      " *   \"activityStatus\": \"ACTIVE\",",
                      " *   \"contactDetails\": {",
                      " *     \"firstName\": \"Claude\",",
                      " *     \"lastName\": \"Morales\",",
                      " *     \"phones\": [",
                      " *       \"0747-769-460\"",
                      " *     ],",
                      " *     \"emails\": [",
                      " *       \"claude.morales@example.com\"",
                      " *     ],",
                      " *     \"addresses\": [",
                      " *       {",
                      " *         \"_id\": \"f0f4d905-488d-44db-9080-fc29078cfad5\",",
                      " *         \"addressLine\": \"9373 Park Avenue\",",
                      " *         \"addressLine2\": \"Berkshire\",",
                      " *         \"city\": \"Ely\",",
                      " *         \"subdivision\": \"GB-ENG\",",
                      " *         \"country\": \"GB\",",
                      " *         \"postalCode\": \"PD50 8EU\"",
                      " *       },",
                      " *       {",
                      " *         \"country\": \"IL\"",
                      " *       }",
                      " *     ],",
                      " *     \"customFields\": {}",
                      " *   },",
                      " *   \"profile\": {",
                      " *     \"nickname\": \"Claude Morales\",",
                      " *     \"slug\": \"claudemorales\"",
                      " *   }",
                      " * }",
                      " */" ],
                  "extra":
                    {  } } ],
            "extra":
              {  } },
        "extra":
          {  } },
      { "name": "getRoles",
        "labels": [],
        "nameParams": [],
        "params": [],
        "ret":
          { "type":
              { "name": "Promise",
                "typeParams":
                  [ { "name": "Array",
                      "typeParams":
                        [ "wix-members-backend.CurrentMember.Role" ] } ] },
            "doc": "Fulfilled - List of roles.\nRejected - If no member is currently logged in." },
        "locations":
          [ { "lineno": 27,
              "filename": "getRoles.js" } ],
        "docs":
          { "summary": "Retrieves the member's roles.",
            "description":
              [ "The `getRoles()` function returns a Promise that resolves to the",
                "[roles](https://support.wix.com/en/article/creating-member-roles-6943237)",
                "of the currently logged-in member.",
                "If no member is currently logged in, the Promise is rejected.",
                "",
                "> **Notes:**",
                "> - The APIs in `CurrentMember` are only partially functional when previewing your site. View a published version of your site to see their complete functionality.",
                "> - This function replaces the deprecated `wix-users-backend.currentUser.getRoles()`. The deprecated function will continue to work, but it will not receive updates. To keep any existing code compatible with future changes, see the [migration instructions](wix-users-backend/user/role#migration-instructions).",
                "",
                "The following results are returned depending on the session identity:",
                "",
                "| Session Identity                                 | Promise Resolves To                                                    |",
                "| ------------------------------------------------ | ---------------------------------------------------------------------- |",
                "| Logged-in member                                 | Array of member roles                                                  |",
                "| Site owner or contributor with admin permissions | Array of member roles, plus an additional role where `name` is `Admin` |",
                "| Anyone else                                      | Promise is rejected                                                    |" ],
            "links": [],
            "examples":
              [ { "title": "Get the currently logged-in member's roles",
                  "body":
                    [ "import { currentMember } from 'wix-members-backend';",
                      "",
                      "export function myGetRolesFunction() {",
                      "  return currentMember.getRoles()",
                      "    .then((roles) => {",
                      "      return roles;",
                      "    })",
                      "    .catch((error) => {",
                      "      console.error(error);",
                      "    });",
                      "}",
                      "",
                      "/* Promise resolves to:",
                      " * [",
                      " *   {",
                      " *     \"_id\": \"42082477-9616-4f15-bf1d-64b2b3049a42\",",
                      " *     \"_createdDate\": \"2021-01-31T23:26:56.089Z\",",
                      " *     \"title\": \"Forum Gatekeeper\",",
                      " *     \"description\": \"Can approve or block members, close discussions, and delete posts\",",
                      " *     \"color\": \"LIGHT_GREEN\"",
                      " *   },",
                      " *   {",
                      " *     \"_id\": \"9c3501b4-b8e0-4970-8795-d8ecfea698b7\",",
                      " *     \"_createdDate\": \"2021-01-31T23:26:17.535Z\",",
                      " *     \"title\": \"Forum Mod\",",
                      " *     \"description\": \"Can approve posts from new members and lock discussions\",",
                      " *     \"color\": \"VIOLET\"",
                      " *   },",
                      " *   {",
                      " *     \"_id\": \"00000000-0000-0000-0000-000000000001\",",
                      " *     \"title\": \"Admin\",",
                      " *     \"color\": \"DARK_BLUE\"",
                      " *   }",
                      " * ]",
                      " */" ],
                  "extra":
                    {  } } ],
            "extra":
              {  } },
        "extra":
          {  } },
      { "name": "makeProfilePrivate",
        "labels": [],
        "nameParams": [],
        "params": [],
        "ret":
          { "type":
              { "name": "Promise",
                "typeParams":
                  [ "wix-members-backend.Members.Member" ] },
            "doc": "Fulfilled - Updated member." },
        "locations":
          [ { "lineno": 1,
              "filename": "makeProfilePrivate.js" } ],
        "docs":
          { "summary": "Removes the currently logged-in member from the site community and sets their profile to private.",
            "description":
              [ "<!--ONLY:VELO-->",
                "The `makeProfilePrivate()` function returns a Promise that resolves to a member object",
                "when the member's profile privacy is updated.",
                "<!--END:ONLY:VELO-->",
                "",
                "When a member's profile is private,",
                "they do not have access to the site's",
                "[Members Area](https://support.wix.com/en/article/about-members-area)",
                "features,",
                "and their profile is hidden from other members and site visitors.",
                "",
                "> **Notes:**",
                "> - The APIs in `CurrentMember` are only partially functional when previewing your site. View a published version of your site to see their complete functionality.",
                "> - If a public member profile changes to private, their public content (such as forum posts and blog comments) remains publicly visible." ],
            "links":
              [ "[makeProfilePublic( )](#makeProfilePublic)" ],
            "examples":
              [ { "title": "Make the currently logged-in member's profile private",
                  "body":
                    [ "import { currentMember } from 'wix-members-backend';",
                      "",
                      "export function myMakeProfilePrivateFunction() {",
                      "  return currentMember.makeProfilePrivate()",
                      "    .then((updatedMember) => {",
                      "      const newPrivacyStatus = updatedMember.privacyStatus;",
                      "      return updatedMember;",
                      "    })",
                      "    .catch((error) => {",
                      "      console.error(error);",
                      "    })",
                      "}",
                      "",
                      "/* Promise resolves to:",
                      " * {",
                      " *   \"_id\": \"f32cbc51-a331-442b-86c2-2c664613e8b9\",",
                      " *   \"_createdDate\": \"2021-08-02T23:14:42.000Z\",",
                      " *   \"_updatedDate\": \"2021-08-02T23:14:58.345Z\",",
                      " *   \"lastLoginDate\": \"2021-08-04T11:02:44.000Z\",",
                      " *   \"contactId\": \"f32cbc51-a331-442b-86c2-2c664613e8b9\",",
                      " *   \"loginEmail\": \"claude.morales@example.com\",",
                      " *   \"status\": \"APPROVED\",",
                      " *   \"privacyStatus\": \"PRIVATE\",",
                      " *   \"activityStatus\": \"ACTIVE\",",
                      " *   \"contactDetails\": {",
                      " *     \"firstName\": \"Claude\",",
                      " *     \"lastName\": \"Morales\",",
                      " *     \"phones\": [",
                      " *       \"0747-769-460\"",
                      " *     ],",
                      " *     \"emails\": [",
                      " *       \"claude.morales@example.com\"",
                      " *     ],",
                      " *     \"addresses\": [",
                      " *       {",
                      " *         \"_id\": \"f0f4d905-488d-44db-9080-fc29078cfad5\",",
                      " *         \"addressLine\": \"9373 Park Avenue\",",
                      " *         \"addressLine2\": \"Berkshire\",",
                      " *         \"city\": \"Ely\",",
                      " *         \"subdivision\": \"GB-ENG\",",
                      " *         \"country\": \"GB\",",
                      " *         \"postalCode\": \"PD50 8EU\"",
                      " *       },",
                      " *       {",
                      " *         \"country\": \"IL\"",
                      " *       }",
                      " *     ],",
                      " *     \"customFields\": {}",
                      " *   },",
                      " *   \"profile\": {",
                      " *     \"nickname\": \"Claude Morales\",",
                      " *     \"slug\": \"claudemorales\"",
                      " *   }",
                      " * }",
                      " */" ],
                  "extra":
                    {  } } ],
            "extra":
              {  } },
        "extra":
          {  } },
      { "name": "makeProfilePublic",
        "labels": [],
        "nameParams": [],
        "params": [],
        "ret":
          { "type":
              { "name": "Promise",
                "typeParams":
                  [ "wix-members-backend.Members.Member" ] },
            "doc": "Fulfilled - Updated member." },
        "locations":
          [ { "lineno": 1,
              "filename": "makeProfilePublic.js" } ],
        "docs":
          { "summary": "Joins the currently logged-in member to the site community and sets their profile to public.",
            "description":
              [ "<!--ONLY:VELO-->",
                "The `makeProfilePublic()` function returns a Promise that resolves to a member object",
                "when the member's profile privacy is updated.",
                "<!--END:ONLY:VELO-->",
                "",
                "When a member's profile is public,",
                "they have access to the site's",
                "[Members Area](https://support.wix.com/en/article/about-members-area)",
                "features — such as chat, forum, and followers —",
                "and their profile is visible to other members and site visitors.",
                "> **Note:**",
                "> The APIs in `CurrentMember` are only partially functional when previewing your site. View a published version of your site to see their complete functionality." ],
            "links":
              [ "[makeProfilePrivate( )](#makeProfilePrivate)" ],
            "examples":
              [ { "title": "Make the currently logged-in member's profile public",
                  "body":
                    [ "import { currentMember } from 'wix-members-backend';",
                      "",
                      "export function myMakeProfilePublicFunction() {",
                      "  return currentMember.makeProfilePublic()",
                      "    .then((updatedMember) => {",
                      "      const newPrivacyStatus = updatedMember.privacyStatus;",
                      "      return updatedMember;",
                      "    })",
                      "    .catch((error) => {",
                      "      console.error(error);",
                      "    })",
                      "}",
                      "",
                      "/* Promise resolves to:",
                      " * {",
                      " *   \"_id\": \"f32cbc51-a331-442b-86c2-2c664613e8b9\",",
                      " *   \"_createdDate\": \"2021-08-02T23:14:42.000Z\",",
                      " *   \"_updatedDate\": \"2021-08-02T23:14:58.345Z\",",
                      " *   \"lastLoginDate\": \"2021-08-04T11:02:44.000Z\",",
                      " *   \"contactId\": \"f32cbc51-a331-442b-86c2-2c664613e8b9\",",
                      " *   \"loginEmail\": \"claude.morales@example.com\",",
                      " *   \"status\": \"APPROVED\",",
                      " *   \"privacyStatus\": \"PUBLIC\",",
                      " *   \"activityStatus\": \"ACTIVE\",",
                      " *   \"contactDetails\": {",
                      " *     \"firstName\": \"Claude\",",
                      " *     \"lastName\": \"Morales\",",
                      " *     \"phones\": [",
                      " *       \"0747-769-460\"",
                      " *     ],",
                      " *     \"emails\": [",
                      " *       \"claude.morales@example.com\"",
                      " *     ],",
                      " *     \"addresses\": [",
                      " *       {",
                      " *         \"_id\": \"f0f4d905-488d-44db-9080-fc29078cfad5\",",
                      " *         \"addressLine\": \"9373 Park Avenue\",",
                      " *         \"addressLine2\": \"Berkshire\",",
                      " *         \"city\": \"Ely\",",
                      " *         \"subdivision\": \"GB-ENG\",",
                      " *         \"country\": \"GB\",",
                      " *         \"postalCode\": \"PD50 8EU\"",
                      " *       }",
                      " *     ],",
                      " *     \"customFields\": {}",
                      " *   },",
                      " *   \"profile\": {",
                      " *     \"nickname\": \"Claude Morales\",",
                      " *     \"slug\": \"claudemorales\"",
                      " *   }",
                      " * }",
                      " */" ],
                  "extra":
                    {  } } ],
            "extra":
              {  } },
        "extra":
          {  } },
      { "name": "updateSlug",
        "labels": [],
        "nameParams": [],
        "params":
          [ { "name": "slug",
              "type": "string",
              "doc": "New slug." } ],
        "ret":
          { "type":
              { "name": "Promise",
                "typeParams":
                  [ "wix-members-backend.Members.Member" ] },
            "doc": "Fulfilled - Updated member." },
        "locations":
          [ { "lineno": 1,
              "filename": "updateSlug.js" } ],
        "docs":
          { "summary": "Changes the currently logged-in member's slug.",
            "description":
              [ "The `updateSlug()` function returns a Promise that resolves to a member",
                "after the member's slug is changed.",
                "> **Note:**",
                "> The APIs in `CurrentMember` are only partially functional when previewing your site. View a published version of your site to see their complete functionality." ],
            "links": [],
            "examples":
              [ { "title": "Update the currently logged-in member's slug",
                  "body":
                    [ "import { currentMember } from 'wix-members-backend';",
                      "",
                      "// Sample slug value:",
                      "// 'claude-morales-new-slug'",
                      "",
                      "export function myUpdateSlugFunction(slug) {",
                      "  return currentMember.updateSlug(slug)",
                      "    .then((updatedMember) => {",
                      "      const updatedSlug = member.profile.slug;",
                      "      const memberProfilePage = `https://yoursite.com/profile/${updatedSlug}/profile`;",
                      "",
                      "      return updatedMember;",
                      "    })",
                      "    .catch((error) => {",
                      "      console.error(error);",
                      "    });",
                      "}",
                      "",
                      "/* Promise resolves to:",
                      " * {",
                      " *     \"_id\": \"f32cbc51-a331-442b-86c2-2c664613e8b9\",",
                      " *     \"_createdDate\": \"2021-08-02T23:14:42.000Z\",",
                      " *     \"_updatedDate\": \"2021-08-02T23:14:58.345Z\",",
                      " *     \"loginEmail\": \"claude.morales@example.com\",",
                      " *     \"status\": \"APPROVED\",",
                      " *     \"contactId\": \"f32cbc51-a331-442b-86c2-2c664613e8b9\",",
                      " *     \"privacyStatus\": \"PUBLIC\",",
                      " *     \"activityStatus\": \"ACTIVE\",",
                      " *     \"lastLoginDate\": \"2021-08-04T05:10:21.000Z\",",
                      " *     \"contactDetails\": {",
                      " *         \"firstName\": \"Claude\",",
                      " *         \"lastName\": \"Morales\",",
                      " *         \"phones\": [",
                      " *             \"0747-769-460\"",
                      " *         ],",
                      " *         \"emails\": [",
                      " *             \"claude.morales@example.com\"",
                      " *         ],",
                      " *         \"addresses\": [",
                      " *             {",
                      " *                 \"_id\": \"f0f4d905-488d-44db-9080-fc29078cfad5\",",
                      " *                 \"addressLine\": \"9373 Park Avenue\",",
                      " *                 \"addressLine2\": \"Berkshire\",",
                      " *                 \"city\": \"Ely\",",
                      " *                 \"subdivision\": \"GB-ENG\",",
                      " *                 \"country\": \"GB\",",
                      " *                 \"postalCode\": \"PD50 8EU\"",
                      " *             },",
                      " *             {",
                      " *                 \"country\": \"IL\"",
                      " *             }",
                      " *         ],",
                      " *         \"customFields\": {}",
                      " *     },",
                      " *     \"profile\": {",
                      " *         \"nickname\": \"Claude Morales\",",
                      " *         \"slug\": \"claude-morales-new-slug\"",
                      " *     }",
                      " * }",
                      " */" ],
                  "extra":
                    {  } },
                { "title": "Allow a member to change their own slug",
                  "body":
                    [ "/**********************************",
                      " * Backend code - change-slug.jsw *",
                      " *********************************/",
                      "",
                      "import { currentMember } from 'wix-members-backend';",
                      "",
                      "export async function changeMemberSlug(slug) {",
                      "  // Validate the slug passed to this function.",
                      "  // This rule enforces that the slug can contain only lowercase letters (a-z),",
                      "  // numbers (0-9), hyphens (-), underscores (_), and pluses (+).",
                      "  // If the test passes, isValid is set to true.",
                      "  const comparison = /^[a-z0-9-_+]+$/m;",
                      "  const isValid = comparison.test(slug);",
                      "",
                      "  if (isValid === true) {",
                      "",
                      "    const updatedMember = await currentMember.updateSlug(slug);",
                      "    return {",
                      "      result: 'updated',",
                      "      member: updatedMember",
                      "    };",
                      "",
                      "  } else {",
                      "",
                      "    return {",
                      "      result: 'not_updated',",
                      "      reason: 'Invalid slug. Slug can contain only a-z, 0-9, -, _, or +'",
                      "    };",
                      "",
                      "  }",
                      "}",
                      "",
                      "",
                      "/*************",
                      " * Page code *",
                      " ************/",
                      "",
                      "import { changeMemberSlug } from 'backend/change-slug';",
                      "",
                      "// ...",
                      "",
                      "$w('#updateSlugButton').onClick(async () => {",
                      "  console.log('Updating slug...');",
                      "",
                      "  const newSlug = $w('#newSlug').value;",
                      "",
                      "  // Pass the new slug to the backend changeMemberSlug()",
                      "  const updateSlugResponse = await changeMemberSlug(newSlug);",
                      "",
                      "  if (updateSlugResponse.result === 'updated') {",
                      "",
                      "    const updatedSlug = updateSlugResponse.member.profile.slug;",
                      "    const memberProfilePage = `https://yoursite.com/profile/${updatedSlug}/profile`;",
                      "    console.log('Slug updated. New member profile page:', memberProfilePage);",
                      "",
                      "  } else {",
                      "",
                      "    console.log('Slug not updated. Response:', updateSlugResponse);",
                      "    // Handle case where slug is not updated",
                      "",
                      "  }",
                      "});" ],
                  "extra":
                    { "description": "You can allow the currently logged-in member to change their slug\nby providing a text box (in this example, `#newSlug`)\nand passing the value to a backend function that calls `updateSlug()`.\n\nThis example also includes backend validation,\nwhich enforces a limit on the characters the slug can include.\nThis allows you to apply the same validation to any number of inputs across your site." } } ],
            "extra":
              {  } },
        "extra":
          {  } } ],
  "callbacks": [],
  "messages":
    [ { "name": "Role",
        "locations":
          [ { "lineno": 1,
              "filename": "getRoles.js" } ],
        "docs":
          { "links": [],
            "examples": [],
            "extra":
              {  } },
        "members":
          [ { "name": "_id",
              "type": "string",
              "doc": "Role ID." },
            { "name": "title",
              "type": "string",
              "doc": "Role name as defined in the site's\n [Member Permissions](https://www.wix.com/my-account/site-selector/?buttonText=Select%20Site&title=Select%20a%20Site&autoSelectOnSingleSite=true&actionUrl=https:%2F%2Fwww.wix.com%2Fdashboard%2F%7B%7BmetaSiteId%7D%7D%2Fmember-permissions/roles)\n page or one of `\"Admin\"` or `\"Member\"`." },
            { "name": "description",
              "type": "string",
              "doc": "Role description, if defined in the site's dashboard.",
              "optional": true },
            { "name": "color",
              "type": "string",
              "doc": "Role color, as defined in the site's\n[Member Permissions](https://www.wix.com/my-account/site-selector/?buttonText=Select%20Site&title=Select%20a%20Site&autoSelectOnSingleSite=true&actionUrl=https:%2F%2Fwww.wix.com%2Fdashboard%2F%7B%7BmetaSiteId%7D%7D%2Fmember-permissions/roles)\npage.\n\nOne of:\n\n- `\"DARK_BLUE\"`\n- `\"LIGHT_BLUE\"`\n- `\"TEAL\"`\n- `\"LIGHT_GREEN\"`\n- `\"YELLOW\"`\n- `\"ORANGE\"`\n- `\"RED\"`\n- `\"VIOLET\"`\n- `\"PURPLE\"`" },
            { "name": "_createdDate",
              "type": "Date",
              "doc": "Date and time the role was created.",
              "optional": true } ],
        "extra":
          {  },
        "labels": [] } ],
  "extra":
    {  } }