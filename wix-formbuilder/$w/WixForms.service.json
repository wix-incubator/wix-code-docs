{ "name": "WixForms",
  "memberOf": "$w",
  "mixes":
    [ "$w.HiddenCollapsedMixin" ],
  "labels":
    [ "changed" ],
  "location":
    { "lineno": 1,
      "filename": "form.js" },
  "docs":
    { "summary": "A `$w` element for enabling your site contacts and visitors to work with the Wix Forms app.",
      "description":
        [ "The [Wix Forms app](https://support.wix.com/en/article/about-wix-forms) lets site visitors enter values for fields in a Wix Form and then submit it. ",
          "",
          " The `WixForms` API contains what you need to work with the [Wix Forms app](https://support.wix.com/en/article/velo-working-with-forms)",
          " using Velo APIs. You can customize how site visitors work with the Wix Form, while ",
          " taking advantage of the Wix Forms app's ease of design, automatic creation of submission collections, ",
          " payment receipt, automatic setup of email notifications, and more. ",
          " ",
          " You do not need to import `$w` or `wix-crm` to work with `WixForms` APIs.",
          "",
          " ### Working with the WixForms API",
          "",
          "",
          " To work with a `WixForms` `$w` element using the API: ",
          "",
          " 1. [Add and set up](https://support.wix.com/en/article/adding-and-setting-up-a-form-on-your-site) the ",
          "    Wix Form app on your site. ",
          "",
          "    When you add the `$w` [`WixForms`](wix-crm.html#$w-wixforms) element, a `$w` [`Form`]($w.html#form) element ",
          "    is also added, with its own properties and events. Think of the `Form` element as a container for the Wix ",
          "    Form's input elements and buttons. These two elements work together, meaning, if ",
          "    you hide or collapse either the `WixForms` or the `Form` element, the other element is also hidden/collapsed. ",
          "    All Wix Forms app's APIs are used on the `WixForms` element, not the `Form` element. ",
          " ",
          " 1. Set up the collection for form data.",
          "",
          "    Depending on the form you choose, a [Wix app starter collection](https://support.wix.com/en/article/velo-working-with-wix-app-collections-and-code#what-are-wix-app-starter-collections) ",
          "    is added to your site. You can see it in the Velo sidebar in Content Collections in the Databases section. You can use this collection \"as is,\"",
          "    or you can use the collection as a template, modifying its fields as you like.",
          "",
          " 1. Use the `WixForms` APIs to handle events and submit data to the server for processing.",
          " ",
          "",
          "",
          "",
          " The `WixForms` API does not use functionality provided by [`FormElement`]($w.html#FormElement), ",
          " but the user input elements that are wrapped within the corresponding [`Form`]($w.html#form) element can. For example, you cannot check if a Wix Form has changed ",
          " using [`onChange`]($w.formelement.html#onChange), but you can check if one of the Wix Form's `Form` fields has changed.",
          " ",
          " > **Note:** Alternatively, instead of using the Wix Forms APIs, you can use the Velo API to ",
          " create your own custom form without the Wix Forms app and connect ",
          " the form's fields to a custom collection. You can create the custom form with standard input elements ",
          " and a button for submission. When customizing your own form, you have ",
          " options that might not yet be available from the Wix Forms app. For example, you can add more ",
          " varied input elements not yet supported by the app. ",
          "",
          " ",
          " ### Event Handling",
          "",
          " This diagram shows the order that Wix Forms events are handled:  ",
          " ",
          " ![Wix Forms Event Handling](./assets/images/wix_forms_events_flow.png)",
          "  ",
          " When a visitor clicks the Submit button:",
          " ",
          "",
          " 1. The [`onWixFormSubmit()`](#onWixFormSubmit) event handler sets events that fire ",
          "    when a site visitor submits a Wix Form yet before the Wix Form is actually sent to the server. ",
          "    ",
          "    The `onWixFormSubmit()` event handler runs on the client side. ",
          "",
          "    Generally you define all validations and operations in one `onWixFormSubmit` event handler. ",
          "    You can define more than one `onWixFormSubmit` event handler, for example, if you like to split your code into ",
          "    chunks. ",
          "",
          "    Use the [`onWixFormSubmitted()`](#onWixFormSubmitted) event handler to check that the data for the Wix Form was successfully ",
          "    submitted to the server.",
          "",
          "    > **Note**: assuming an `onClick()` event handler is also defined, both its events and the `onWixFormSubmitted` events fire when ",
          "    > a site visitor clicks the Wix Form's Submit button.  ",
          "",
          " 1. After the `WixFormSubmit` events are fired, the Wix Form is sent to the server. The submission",
          "    either succeeds or fails: ",
          "",
          "    * If the Wix Form submission succeeds, the [`onWixFormSubmitted`](#onWixFormSubmitted) event handler runs.",
          "      `onWixFormSubmitted` sets events that fire when a site visitor submits a ",
          "      Wix Form and the form is *successfully* sent to the server for asynchronous processing. ",
          "",
          "      Use this event handler to handle client side operations, such as displaying a message ",
          "      indicating the successful submission. The event handler starts even while the ",
          "      server is still performing its own backend operations. ",
          "",
          "    * If the Wix Form submission fails, the [`onWixFormSubmittedError`](#onWixFormSubmittedError) event handler is fired. ",
          "",
          "      Use this event handler to define client side operations for failed submits,",
          "      such as displaying a message requesting the visitor try again later.",
          "",
          " 1. The [`onFormSubmit()`](wix-crm-backend/events/onFormSubmit) backend event handler starts as soon as the Wix Form is received by the server. ",
          "    and asynchronous backend processing starts. For example, use this event handler to ",
          "    send an email indicating that the Wix Form was submitted and at what time it was submitted." ],
      "links": [],
      "examples": [],
      "extra":
        {  } },
  "properties": [],
  "operations":
    [ { "name": "onWixFormSubmit",
        "labels": [],
        "nameParams": [],
        "params":
          [ { "name": "eventHandler",
              "type": "$w.WixForms.WixFormSubmitEventHandler",
              "doc": "The name of the function or\n the function expression to run when a Wix Form is submitted." } ],
        "ret":
          { "type": "void" },
        "locations":
          [ { "lineno": 103,
              "filename": "form.js" } ],
        "docs":
          { "summary": "Adds an event handler that runs when a site visitor starts to submit a Wix Form yet before the form is actually submitted and sent to the server.",
            "description":
              [ "When a site visitor submits a Wix Form, the `onWixFormSubmit()` event handler runs for the [`WixForms`](wix-crm.html#$w-wixforms) ",
                " element before the Wix Form data are submitted to the server. ",
                "",
                " The callback to run when the Wix Form that is about to be submitted is either the name of the function",
                " or a function expression.",
                "",
                " The event handler can contain synchronous operations only. If you include asynchronous operations, no error is issued ",
                " and the asynchronous operations are ignored.",
                "",
                " Generally, define form validations and operations in one `onWixFormSubmit()` event handler. ",
                " ",
                " > **Note:** You can define more than one `onWixFormSubmit()`, for example, if you prefer to split your code into ",
                " chunks. Keep in mind that all validations for all the event handlers must succeed for their operations to be ",
                " performed and for the data to be sent to the server. ",
                "",
                " The event handler runs in parallel with any operations defined in an `onClick()` event handler.",
                "",
                " > **Note**: Do not explicitly include the `onWixFormSubmit()` inside an `onCLick()`.  This is because `onWixFormSubmit()`",
                " must be loaded before an `onClick()` event handler runs.",
                " ",
                " The `onWixFormSubmit()` event handler does the following: ",
                "",
                " + Performs built-in, general validations (such as checking that all email",
                "   fields contain valid email addresses). ",
                "",
                "   These validations are performed without your needing to code them.  ",
                "",
                "   If the form fields do not pass validation, the submission of the Wix Form data ",
                "   to the server is aborted. ",
                "",
                " + Performs client-side, synchronous operations and validations that you define in the event handler.",
                " ",
                "   This gives you the opportunity to manipulate the data on the Wix Form before submitting the data for server ",
                "   processing. For example, the Wix Form might have first and last name fields, but the server might be expecting",
                "   full names only. You can combine the first and last name into one field before sending the data to the",
                "   server.",
                "",
                "   These manipulations cannot include adding new fields or deleting fields. You can only change values of existing Wix Form fields.",
                "",
                " + Lets you stop the submission process entirely by returning a `false` value based on validations you define. ",
                "   ",
                "   If a `WixFormSubmitEvent` event fails, operations for all `WixFormSubmitEvent` event stop, no submission occurs, and ",
                "   console warnings are issued. You can use the [`onWixFormSubmitted()`](#onWixFormSubmitted) event handler to check ",
                "   if data for the Wix Form was successfully submitted to the server.",
                "",
                "",
                "",
                " The received `WixFormSubmitEvent` object ",
                " contains information about the Wix Form that is about to be submitted. The `WixFormSubmitEvent` object is returned by the ",
                " callback asynchronously after a submit was requested, before the server receives the request, and before ",
                " the server starts to process the relevant operations.",
                "",
                "",
                " `onWixFormSubmit()` provides information and functionality available on the client side only:",
                "",
                " + The function has access to the field names and field values on the form but does not have access to submission details that ",
                "   exist only on the server, such as the contact ID and the submission time.",
                " + The function performs operations only on the client side, such as changing field values before submission to the server. ",
                "",
                "",
                "",
                " For other Wix Forms events, see: ",
                "",
                " + The [`onWixFormSubmitted()`](#onWixFormSubmitted) event handler, which sets events that fire when a site visitor submits a Wix Form and it is successfully received by the server. ",
                " + The [`onWixFormSubmittedError()`](#onWixFormSubmittedError) event handler, which sets events that fire when a site visitor submits a Wix Form and it is *not* received by the server. ",
                " + The [`onFormSubmit()`](wix-crm-backend/events/onFormSubmit) event handler, which is called in the Backend section's code, to set events that fire on the backend when a site visitor submits a form." ],
            "links":
              [ "[WixFormSubmitEvent](#WixFormSubmitEvent)",
                "[onWixFormSubmitError](#onWixFormSubmitError)" ],
            "examples":
              [ { "title": "Trigger processing for a Wix Form before it is submitted to the server",
                  "body":
                    [ "// Switch the order of the names entered in the full name field",
                      "// before submitting to server.",
                      "$w(\"#wixForms1\").onWixFormSubmit((event) => {",
                      "  let fullName = event.fields[0].fieldValue;",
                      "  let fullNameArray = fullName.split(\" \");",
                      "  event.fields[0].fieldValue = fullNameArray[1] + \", \" + fullNameArray[0];",
                      "  let email = event.fields[1].fieldValue;",
                      "  return event.fields;",
                      "});",
                      "",
                      "/* fields array of objects before onWixFormSubmit():",
                      " * ",
                      " * [",
                      " *   { ",
                      " *    \"id\" : \"inputName\",",
                      " *    \"fieldValue\" : \"Jane Doe\",",
                      " *    \"fieldName\" : \"Enter first name and then last name, with a space separator.\"",
                      " *   },",
                      " *   { ",
                      " *    \"id\" : \"inputEmail\",",
                      " *    \"fieldValue\" : \"jd@theCompany\",",
                      " *    \"fieldName\" : \"Enter email.\"",
                      " *   }",
                      " * ] ",
                      " * ",
                      " *  ",
                      " *  fields array of objects after onWixFormSubmit():",
                      " * ",
                      " *  [ ",
                      " *    { ",
                      " *      \"id\" : \"inputName\",",
                      " *      \"fieldValue\" : \"Doe, Jane\",",
                      " *      \"fieldName\" : \"Enter the last name and then the first name, separated by a space.\"",
                      " *    },",
                      " *    { ",
                      " *      \"id\" : \"inputEmail\",",
                      " *      \"fieldValue\" : \"jd@theCompany\",",
                      " *      \"fieldName\" : \"Enter email.\"",
                      " *    }",
                      " * ] ",
                      " */" ],
                  "extra":
                    {  } },
                { "title": "Trigger a \"go/no-go\" decision determining if a Wix Form should be submitted",
                  "body":
                    [ "// Check if the member entered a name in  ",
                      "// the form field at position 0 in the fields array.",
                      "$w(\"#wixForms1\").onWixFormSubmit((event) => {",
                      "  if (typeof event.fields[0].fieldValue == \"undefined\" || event.fields[0].fieldValue === \"\") ",
                      "      return false;",
                      "  } else ",
                      "      return true;",
                      "});" ],
                  "extra":
                    {  } } ],
            "extra":
              {  } },
        "extra":
          { "eventType": "WixFormSubmitEvent" } },
      { "name": "onWixFormSubmitted",
        "labels":
          [ "changed" ],
        "nameParams": [],
        "params":
          [ { "name": "eventHandler",
              "type": "$w.WixForms.WixFormSubmittedEventHandler",
              "doc": "The name of the function or\n the function expression to run when a Wix Form is submitted." } ],
        "ret":
          { "type": "void" },
        "locations":
          [ { "lineno": 187,
              "filename": "form.js" } ],
        "docs":
          { "summary": "Adds an event handler that runs when a site visitor submits a Wix Form and it is successfully received by the server.",
            "description":
              [ "When the site visitor submits a Wix Form, the field values are cleared and the `onWixFormSubmitted()`",
                " callback runs for the [`WixForms`](wix-crm.html#$w-wixforms) element. ",
                "",
                " The callback to run when the Wix Form is submitted is either the name of the function",
                " or a function expression.",
                "",
                " The received `WixFormSubmittedEvent` object ",
                " contains information about the Wix Form that was submitted. The `WixFormSubmittedEvent` object is returned by the ",
                " callback asynchronously following verification of a successful submission, while the server starts to process the",
                " relevant actions.",
                "",
                "",
                " `onWixFormSubmitted()` provides information and functionality available on the client side:",
                "",
                " + The function has access to the field names and field values on the form but does not have access to submission details that exist only on the server, such as the contact ID and the submission time.",
                " + The function performs operations only on the client side, such as displaying a message after submission. ",
                "",
                "",
                " For other Wix Forms events, see: ",
                "",
                " + The [`onWixFormSubmit()`](#onWixFormSubmit) event handler, which sets events that fire when a site visitor submits a Wix Form yet before it is sent to the server. ",
                " + The [`onWixFormSubmittedError()`](#onWixFormSubmittedError) event handler, which sets events that fire when a site visitor submits a Wix Form and it is *not* received by the server. ",
                " + The [`onFormSubmit()`](wix-crm-backend/events/onFormSubmit) event handler, which is called in the Backend section's code, to set events that fire on the backend when a site visitor submits a form." ],
            "links":
              [ "[WixFormSubmittedEvent](#WixFormSubmittedEvent)",
                "[onWixFormSubmittedError](#onWixFormSubmittedError)" ],
            "examples":
              [ { "title": "An event is fired on a WixForms element when the Wix Form is submitted",
                  "body":
                    [ "$w(\"#myWixForm\").onWixFormSubmitted( ( {fields} ) => {",
                      "  let firstName = fields[0].fieldValue;",
                      "  let lastName = fields[1].fieldValue;",
                      "  let donation = fields[2].fieldValue;",
                      "  let email = fields[3].fieldValue;",
                      "  $w('#myText').text = `Thank you, ${firstName} ${lastName}, for your generous donation of ${donation}.`;",
                      "});",
                      "",
                      "/* fields array of objects: ",
                      " * [",
                      " *    { ",
                      " *      \"id\" : \"inputFirstName\",",
                      " *      \"fieldValue\" : \"Maria\",",
                      " *      \"fieldName\" : \"Enter first name\"",
                      " *    },",
                      " *    { ",
                      " *      \"id\" : \"inputLastName\",",
                      " *      \"fieldValue\" : \"Santora\",",
                      " *      \"fieldName\" : \"Enter last name\"",
                      " *    },",
                      " *    { ",
                      " *      \"id\" : \"inputDonation\",",
                      " *      \"fieldValue\" : \"1000\",",
                      " *      \"fieldName\" : \"Enter donation amount\"",
                      " *    },",
                      " *    { ",
                      " *      \"id\" : \"inputEmail\",",
                      " *      \"fieldValue\" : \"ms@theCompany\",",
                      " *      \"fieldName\" : \"Enter email\"",
                      " *    }",
                      " * ] ",
                      " */" ],
                  "extra":
                    {  } } ],
            "extra":
              {  } },
        "extra":
          { "eventType": "WixFormSubmittedEvent" } },
      { "name": "onWixFormSubmittedError",
        "labels": [],
        "nameParams": [],
        "params":
          [ { "name": "eventHandler",
              "type": "$w.WixForms.WixFormSubmittedErrorEventHandler",
              "doc": "The name of the function or\n the function expression to run when a Wix Form is not submitted due to error." } ],
        "ret":
          { "type": "void" },
        "locations":
          [ { "lineno": 225,
              "filename": "form.js" } ],
        "docs":
          { "summary": "Adds an event handler that runs when a site visitor is not able to successfully submit a Wix Form to the server.",
            "description":
              [ "If a Wix Form has not been successfully submitted by the site visitor, the received",
                " [`WixFormSubmittedErrorEvent`](#WixFormSubmittedErrorEvent) object",
                " contains error information about why the Wix Form could not be submitted. ",
                "",
                " The `WixFormSubmittedErrorEvent` object is returned by the callback asynchronously right after ",
                " an unsuccessful submission.",
                "",
                " The `onWixFormSubmittedError` error handler runs for for the [`WixForms`](wix-crm.html#$w-wixforms) element. The callback to ",
                " run when a submission error occurs is either the name of the function or a function expression.",
                " ",
                "",
                " **Error Codes and Descriptions**",
                "",
                "",
                " * INVALID_FIELD. A field value was not entered correctly by the site visitor.",
                " * FILE\\_NOT\\_UPLOADED. A file or signature upload did not succeed.",
                " * INVALID_ARGUMENT. An internal server error occurred.",
                " * UNAUTHENTICATED. The site member's or visitor's identity was not authenticated.",
                " * PERMISSION_DENIED. The site visitor does not have permissions to submit the Wix Form. For example, a reCAPTCHA challenge was not verified.",
                " * RESOURCE_EXHAUSTED. The request to submit the Wix Form was denied by the server to prevent overload and improve overall performance.",
                " * UNAVAILABLE. The service is not available.",
                " * UNKNOWN_ERROR. An unknown error occurred.",
                "",
                "",
                "",
                "",
                " For other Wix Forms events, see: ",
                "",
                " + The [`onWixFormSubmit()`](#onWixFormSubmit) event handler, which sets events that fire when a site visitor submits a Wix Form yet before it is sent to the server. ",
                " + The [`onWixFormSubmitted()`](#onWixFormSubmitted) event handler, which sets events that fire when a site visitor submits a Wix Form and it is successfully received by the server. ",
                " + The [`onFormSubmit()`](wix-crm-backend/events/onFormSubmit) event handler, which is called in the Backend section's code, to set events that fire on the backend when a site visitor submits a form. *" ],
            "links":
              [ "[WixFormSubmittedErrorEvent](#WixFormSubmittedErrorEvent)",
                "[onWixFormSubmitted](#onWixFormSubmitted)" ],
            "examples":
              [ { "title": "An event that is fired on a WixForms element when the Wix Form is not submitted successfully",
                  "body":
                    [ "$w(\"#myWixForms\").onWixFormSubmittedError(     ",
                      "  (  {code, message}  ) => {",
                      "    $w(\"#errorCodeText\").text = code;",
                      "    $w(\"#errorMessageText\").text = message;",
                      "  });" ],
                  "extra":
                    {  } } ],
            "extra":
              {  } },
        "extra":
          { "eventType": "WixFormSubmittedErrorEvent" } } ],
  "callbacks":
    [ { "name": "WixFormSubmitEventHandler",
        "labels": [],
        "nameParams": [],
        "params":
          [ { "name": "event",
              "type": "$w.WixFormSubmitEvent",
              "doc": "The Wix Forms event that occurred." } ],
        "ret":
          { "type":
              [ "Object",
                "boolean" ],
            "doc": "Either an array of `WixFormField` objects, or a boolean value indicating if the Wix Form should be submitted to the server." },
        "locations":
          [ { "lineno": 271,
              "filename": "form.js" } ],
        "docs":
          { "summary": "Handles events fired when the Wix Form is about to be submitted.",
            "links": [],
            "examples": [],
            "extra":
              {  } },
        "extra":
          {  } },
      { "name": "WixFormSubmittedErrorEventHandler",
        "labels": [],
        "nameParams": [],
        "params":
          [ { "name": "errorEvent",
              "type": "$w.WixFormSubmittedErrorEvent",
              "doc": "The Wix Forms error event that occurred." } ],
        "ret":
          { "type": "void" },
        "locations":
          [ { "lineno": 286,
              "filename": "form.js" } ],
        "docs":
          { "summary": "Handles events fired when the Wix Form is not submitted due to error.",
            "links": [],
            "examples": [],
            "extra":
              {  } },
        "extra":
          {  } },
      { "name": "WixFormSubmittedEventHandler",
        "labels": [],
        "nameParams": [],
        "params":
          [ { "name": "event",
              "type": "$w.WixFormSubmittedEvent",
              "doc": "The Wix Forms event that occurred." } ],
        "ret":
          { "type": "void" },
        "locations":
          [ { "lineno": 279,
              "filename": "form.js" } ],
        "docs":
          { "summary": "Handles events fired when the Wix Form is submitted.",
            "links": [],
            "examples": [],
            "extra":
              {  } },
        "extra":
          {  } } ],
  "messages": [],
  "extra":
    {  } }