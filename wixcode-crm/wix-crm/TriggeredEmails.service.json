{ "name": "TriggeredEmails",
  "memberOf": "wix-crm",
  "mixes": [],
  "labels": [],
  "location":
    { "lineno": 1,
      "filename": "index.js" },
  "docs":
    { "summary": "The Triggered Emails API is used to send triggered emails to your site's contacts and members.",
      "description":
        [ "To learn more about Triggered Emails, see:",
          "",
          " - [About Triggered Emails](https://support.wix.com/en/article/about-triggered-emails)",
          " - [Creating a Triggered Email](https://support.wix.com/en/article/creating-a-triggered-email)",
          " - [How to Send a Triggered Email to Contacts with Code](https://support.wix.com/en/article/how-to-send-a-triggered-email-to-contacts-with-code)",
          "",
          "Before using `emailContact()` or `emailMember()`, you must set up at least 1 Triggered Email." ],
      "links": [],
      "examples": [],
      "extra":
        {  } },
  "properties": [],
  "operations":
    [ { "name": "emailContact",
        "labels": [],
        "nameParams": [],
        "params":
          [ { "name": "emailId",
              "type": "string",
              "doc": "ID of the\n[triggered email](https://www.wix.com/my-account/site-selector/?buttonText=Select%20Site&title=Select%20a%20Site&autoSelectOnSingleSite=true&actionUrl=https:%2F%2Fwww.wix.com%2Fdashboard%2F%7B%7BmetaSiteId%7D%7D%2Ftransactional-emails)\nto send." },
            { "name": "contactId",
              "type": "string",
              "doc": "ID of the contact to send the email to." },
            { "name": "options",
              "type": "wix-crm.TriggeredEmails.TriggeredEmailOptions",
              "doc": "Variable values to insert into the email.",
              "optional": true } ],
        "ret":
          { "type":
              { "name": "Promise",
                "typeParams":
                  [ "void" ] },
            "doc": "Fulfilled - When the email is sent.\nRejected - Error message." },
        "locations":
          [ { "lineno": 1,
              "filename": "emailContact.js" } ],
        "docs":
          { "summary": "Sends a triggered email to the current contact.",
            "description":
              [ "To learn more about Triggered Emails, see:",
                "",
                "- [About Triggered Emails](https://support.wix.com/en/article/about-triggered-emails)",
                "- [Creating a Triggered Email](https://support.wix.com/en/article/creating-a-triggered-email)",
                "- [How to Send a Triggered Email to Contacts with Code](https://support.wix.com/en/article/how-to-send-a-triggered-email-to-contacts-with-code)",
                "",
                "> **Note:**",
                "> This function replaces the deprecated",
                "> `wix-crm.emailContact()`.",
                "> The deprecated function will continue to work, but it will not receive updates.",
                "> To keep any existing code compatible with future changes, see the",
                "> [migration instructions](wix-crm/emailcontact#migration-instructions).",
                "",
                "Before using the `emailContact()` function, you need to set up at least one",
                "Triggered Email.",
                "",
                "Specify which email to send by passing the email's ID in the `emailId` parameter.",
                "",
                "You can use this function to send an email the current site visitor only.",
                "To send an email to a contact who is not the",
                "current site visitor, use the wix-crm-backend [`triggeredEmails.emailContact()`](wix-crm-backend/triggeredEmails/emailcontact) function.",
                "",
                "If the specified Triggered Email contains [variables](https://support.wix.com/en/article/using-variables-to-add-personalized-text),",
                "you can pass values for those variables using the optional `options` parameter.",
                "You pass the `options` object,",
                "which contains the values to replace the variables",
                "defined in your triggered email.",
                "The values passed must be strings. If the object you",
                "pass to the `variables` object does not contain a `key:value` pair for a",
                "variable in your Triggered Email, the fallback value defined when creating",
                "your Triggered Email is inserted in place of the variable.",
                "",
                "Note that Triggered Emails generates a code snippet for each of your email",
                "templates. The generated code includes the email's ID and keys for all the",
                "email's variable names. You can copy and paste the snippet into your code.",
                "Then, you need to define values for the `contactId` property and for each",
                "variable key. To learn how to use the generated snippet in your code, see",
                "[How to Send a Triggered Email with Code](https://support.wix.com/en/article/how-to-send-a-triggered-email-with-code)." ],
            "links": [],
            "examples":
              [ { "title": "Send a triggered email to a contact",
                  "body":
                    [ "import { triggeredEmails } from 'wix-crm';",
                      "",
                      "// ...",
                      "",
                      "// Sample emailId value:",
                      "// 'thanks_for_joining'",
                      "//",
                      "// Sample contactId value:",
                      "// 'e6b569cf-e275-598f-9247-e585ad116e66'",
                      "",
                      "triggeredEmails.emailContact(emailId, contactId)",
                      "  .then(() => {",
                      "    console.log('Email was sent to contact');",
                      "  })",
                      "  .catch((error) => {",
                      "    console.error(error);",
                      "  });" ],
                  "extra":
                    {  } },
                { "title": "Send a triggered email with variable values",
                  "body":
                    [ "import { triggeredEmails } from 'wix-crm';",
                      "",
                      "// ...",
                      "",
                      "// Sample emailId value:",
                      "// 'thanks_for_joining'",
                      "//",
                      "// Sample contactId value:",
                      "// 'e6b569cf-e275-598f-9247-e585ad116e66'",
                      "//",
                      "// Sample options value:",
                      "// {",
                      "//   variables: {",
                      "//     firstName: 'Johnny',",
                      "//     lastName: 'Appleseed'",
                      "//   }",
                      "// }",
                      "",
                      "triggeredEmails.emailContact(emailId, contactId, options)",
                      "  .then(() => {",
                      "    console.log('Email was sent to contact');",
                      "  })",
                      "  .catch((error) => {",
                      "    console.error(error);",
                      "  });" ],
                  "extra":
                    {  } },
                { "title": "Send a triggered email to a new contact",
                  "body":
                    [ "import { contacts, triggeredEmails } from 'wix-crm';",
                      "",
                      "$w.onReady(function () {",
                      "  $w('#createContact').onClick(async () => {",
                      "    const firstName = $w('#firstName').value;",
                      "    const lastName = $w('#lastName').value;",
                      "    const email = $w('#email').value;",
                      "    const phone = $w('#phone').value;",
                      "",
                      "    const contactInfo = {",
                      "      name: { first: firstName, last: lastName },",
                      "      emails: [{ email: email }],",
                      "      phones: [{ phone: phone }],",
                      "    };",
                      "",
                      "    let resolvedContact;",
                      "",
                      "    try {",
                      "      resolvedContact = await contacts.appendOrCreateContact(contactInfo);",
                      "      console.log('Resolved to contact', resolvedContact);",
                      "",
                      "      if (resolvedContact.identityType !== 'CONTACT') {",
                      "        console.log('Current contact is already a site member. Not sending a welcome email.');",
                      "",
                      "        // emailContact() cannot be used to email site members.",
                      "        // If you want to email a member, use triggeredEmails.emailMember()",
                      "",
                      "        return;",
                      "      } else {",
                      "",
                      "        const emailId = 'thanks_for_joining';",
                      "        const contactId = resolvedContact.contactId;",
                      "        const options = {",
                      "          variables: { firstName: firstName, lastName: lastName },",
                      "        };",
                      "",
                      "        await triggeredEmails.emailContact(emailId, contactId, options);",
                      "        console.log('Emailed contact');",
                      "      }",
                      "    } catch (error) {",
                      "      console.error(error);",
                      "    }",
                      "  });",
                      "});" ],
                  "extra":
                    {  } } ],
            "extra":
              {  } },
        "extra":
          {  } },
      { "name": "emailMember",
        "labels": [],
        "nameParams": [],
        "params":
          [ { "name": "emailId",
              "type": "string",
              "doc": "ID of the\n[triggered email](https://www.wix.com/my-account/site-selector/?buttonText=Select%20Site&title=Select%20a%20Site&autoSelectOnSingleSite=true&actionUrl=https:%2F%2Fwww.wix.com%2Fdashboard%2F%7B%7BmetaSiteId%7D%7D%2Ftransactional-emails)\nto send." },
            { "name": "memberId",
              "type": "string",
              "doc": "ID of the currently signed-in member to send the email to." },
            { "name": "options",
              "type": "wix-crm.TriggeredEmails.TriggeredEmailOptions",
              "doc": "Variable values to insert into the email.",
              "optional": true } ],
        "ret":
          { "type":
              { "name": "Promise",
                "typeParams":
                  [ "void" ] },
            "doc": "Fulfilled - When the email is sent.\nRejected - Error message." },
        "locations":
          [ { "lineno": 1,
              "filename": "emailMember.js" } ],
        "docs":
          { "summary": "Sends a Triggered Email to the currently logged-in site member.",
            "description":
              [ "To learn more about Triggered Emails, see:",
                "",
                " + [About Triggered Emails](https://support.wix.com/en/article/about-triggered-emails)",
                " + [Creating a Triggered Email](https://support.wix.com/en/article/creating-a-triggered-email)",
                " + [How to Send a Triggered Email to Members with Code](https://support.wix.com/en/article/how-to-send-a-triggered-email-to-members-with-code)",
                "",
                "> **Note:**",
                "> This function replaces the deprecated",
                "> `wix-users.emailUser()`.",
                "> The deprecated function will continue to work, but it will not receive updates.",
                "> To keep any existing code compatible with future changes, see the",
                "> [migration instructions](wix-users/emailuser#migration-instructions).",
                "",
                " Before using the `emailMember()` function, you need to set up at least one",
                " Triggered Email.",
                "",
                " Specify which email to send by passing the email's ID in the `emailId` parameter.",
                "",
                " Specify which member the email is sent to by passing the member's user ID in the `toUser`",
                " parameter. You can only send the email to the currently logged-in",
                " member. You can get that member's ID using the [`id`](wix-members.Member.html#id) property",
                " of the [`currentMember`](#currentMember).",
                "",
                " If the specified Triggered Email contains",
                " [variables](https://support.wix.com/en/article/using-variables-to-add-personalized-text),",
                " you can pass values for those variables using the optional `options` parameter.",
                " You pass a `TriggeredEmailOptions` object",
                " which contains the values to be inserted into your email in place of the variables",
                " defined in that email. The values passed must be strings. If the object you",
                " pass to the `options` parameter does not contain a `key:value` pair for a",
                " variable in your Triggered Email, the fallback value defined when creating",
                " your Triggered Email is inserted in place of the variable.",
                "",
                " Note that Triggered Emails generates a code snippet for each of your email",
                " templates. The generated code includes the email's ID and keys for all the",
                " email's variable names. You can copy and paste the snippet into your code.",
                " Then, you need to define values for the `toUser` property and for each",
                " variable key. To learn how to use the generated snippet in your code, see",
                " [How to Send a Triggered Email with Code](https://support.wix.com/en/article/how-to-send-a-triggered-email-with-code).",
                "",
                "> **Note:**",
                "> The APIs in `wix-crm` are only partially functional when previewing your site.",
                "> View a published version of your site to see their complete functionality." ],
            "links": [],
            "examples":
              [ { "title": "Send a triggered email to the current member",
                  "body":
                    [ "import { triggeredEmails } from 'wix-crm';",
                      "",
                      "// ...",
                      "",
                      "// Sample emailId value:",
                      "// 'thanks_for_joining'",
                      "//",
                      "// Sample memberId value:",
                      "// '72751428-2743-4bda-acf5-4218a4279cd3'",
                      "",
                      "triggeredEmails.emailMember(emailId, memberId)",
                      "  .then(() => {",
                      "    console.log('Email was sent to member');",
                      "  })",
                      "  .catch((error) => {",
                      "    console.error(error);",
                      "  });" ],
                  "extra":
                    {  } },
                { "title": "Send a triggered email to the current member with variables",
                  "body":
                    [ "import { triggeredEmails } from 'wix-crm';",
                      "",
                      "// ...",
                      "",
                      "// Sample emailId value:",
                      "// 'thanks_for_joining'",
                      "//",
                      "// Sample memberId value:",
                      "// '72751428-2743-4bda-acf5-4218a4279cd3'",
                      "//",
                      "// Sample options value:",
                      "// {",
                      "//   variables: {",
                      "//     firstName: 'Johnny',",
                      "//     lastName: 'Appleseed'",
                      "//   }",
                      "// }",
                      "",
                      "triggeredEmails.emailMember(emailId, memberId, options)",
                      "  .then(() => {",
                      "    console.log('Email was sent to member');",
                      "  })",
                      "  .catch((error) => {",
                      "    console.error(error);",
                      "  });" ],
                  "extra":
                    {  } } ],
            "extra":
              {  } },
        "extra":
          {  } } ],
  "callbacks": [],
  "messages":
    [ { "name": "TriggeredEmailOptions",
        "locations":
          [ { "lineno": 1,
              "filename": "triggeredEmails_shared.js" } ],
        "docs":
          { "links": [],
            "examples": [],
            "extra":
              {  } },
        "members":
          [ { "name": "variables",
              "type": "Object",
              "doc": "An object with `key:value` pairs. Each\n `key` is a variable in the email template created in Triggered Emails, and its\n corresponding `value` is the value to insert into the template in place of the\n variable. The values must be strings.\n\nExample: `{ firstName: 'John', lastName: 'Doe' }`" } ],
        "extra":
          {  },
        "labels": [] } ],
  "extra":
    {  } }