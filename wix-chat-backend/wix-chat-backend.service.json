{ "name": "wix-chat-backend",
  "mixes": [],
  "labels":
    [ "changed" ],
  "location":
    { "lineno": 14,
      "filename": "send-message.js" },
  "docs":
    { "summary": "The wix-chat-backend module contains functionality for working with the [Wix Chat](https://support.wix.com/en/article/about-wix-chat) application from backend code.",
      "description":
        [ "Using the backend Chat API, site owners and contributors (referred to as the site's \"business\")",
          "can exchange chat messages with site members, contacts, and visitors (referred to as \"visitors\").",
          "",
          "The backend Chat API is not applicable to social chat. For social chat between site members, use the [client-side Chat API]($w.Chatbox.html).",
          "",
          "**Note:**",
          "",
          "You cannot use a channel programmatically until it is created. A channel is created the first time the business or a visitor sends a message via the chatbox widget to a specific recipient.",
          "",
          "",
          " To use the Chat API, import `wixChat` from the `wix-chat-backend` module:",
          "",
          "   ```javascript",
          "   import wixChatBackend from 'wix-chat-backend';",
          "",
          "  ```" ],
      "links": [],
      "examples": [],
      "extra":
        {  } },
  "properties": [],
  "operations":
    [ { "name": "sendMessage",
        "labels":
          [ "changed" ],
        "nameParams": [],
        "params":
          [ { "name": "messageInfo",
              "type": "wix-chat-backend.MessageInfo",
              "doc": "An object representing the message to be sent." } ],
        "ret":
          { "type":
              { "name": "Promise",
                "typeParams":
                  [ "void" ] },
            "doc": "Fulfilled - When the message is sent." },
        "locations":
          [ { "lineno": 38,
              "filename": "send-message.js" } ],
        "docs":
          { "summary": "Sends a chat message from the backend.",
            "description":
              [ "The `sendMessage()` function sends a text message to a specific channel from",
                " the backend. The message can be from the business to a visitor, or from a",
                " visitor to the business." ],
            "links":
              [ "[`onMessage()`](wix-chat-backend.Events.html#onMessage)" ],
            "examples":
              [ { "title": "Send a chat message from the backend",
                  "body":
                    [ "import wixChatBackend from 'wix-chat-backend';",
                      "",
                      " export function sendChatMessage(messageText, channelId, metadata, sendAsVisitor) {",
                      "   wixChatBackend.sendMessage({",
                      "     \"messageText\": messageText,",
                      "     \"channelId\": channelId,",
                      "     \"metadata\": {metadata},",
                      "     \"sendAsVisitor\": sendAsVisitor",
                      "   })",
                      "   .then( () => {",
                      "     console.log(\"Chat message sent\");",
                      "   })",
                      "   .catch( (error) => {",
                      "     console.log(error);",
                      "   });",
                      " }" ],
                  "extra":
                    {  } },
                { "title": "Get message text from an input element and send it as a chat message",
                  "body":
                    [ "/*************",
                      " * page code *",
                      " *************/",
                      "import { sendChatMessage } from 'backend/chat';",
                      "import wixWindow from 'wix-window';",
                      "",
                      "// ...",
                      "",
                      "export async function sendMessageButton_click(event) {",
                      "  const channel = await $w(\"#myChatbox\").getChannel({ type: \"Business\" });",
                      "  const channelId = channel.id;",
                      "",
                      "  const messageText = $w('#textInput').value;",
                      "  const sendAsVisitor = \"true\";",
                      "",
                      "  sendChatMessage(messageText, channelId, sendAsVisitor);",
                      "}",
                      "",
                      "/****************************",
                      " * Backend code - chat.jsw *",
                      " ****************************/",
                      "import wixChatBackend from 'wix-chat-backend';",
                      "",
                      "export function sendChatMessage(messageText, channelId, sendAsVisitor) {",
                      "  wixChatBackend.sendMessage({",
                      "    \"messageText\": messageText,",
                      "    \"channelId\": channelId,",
                      "    \"sendAsVisitor\": sendAsVisitor",
                      "  })",
                      "}",
                      "",
                      "/**********************************",
                      " * Backend event code - events.js *",
                      " **********************************/",
                      "export function wixChat_onMessage(event) {",
                      "  const chatMessage = event.payload.text;",
                      "  const chatParticipant = event.participantId;",
                      "}",
                      "",
                      "/*  Example SendMessageEvent object:",
                      " *",
                      " *  {",
                      " *    \"channelId\": \"23b345b6-c78d-9012-e3f4-567g89h0i01k\",",
                      " *    \"type\": \"TEXT\",",
                      " *    \"summary\": \"Hey, I've got a question about your products\",",
                      " *    \"participantId\": \"12a345b6-e78f-8011-f3f5-567g89h0i12j\",",
                      " *    \"direction\": \"VisitorToBusiness\",",
                      " *    \"createdAt\": \"2019-10-27T06:02:12.008Z\",",
                      " *    \"payload\": {",
                      " *      \"text\": \"Hey, I've got a question about your products\"",
                      " *    },",
                      " *    \"metadata\": {}",
                      " *  }",
                      " */",
                      "" ],
                  "extra":
                    { "description": "In this example, we use an input element to get the text of a chat message from a site visitor.\n We get the business channel ID and send the chat message to the business." } } ],
            "extra":
              {  } },
        "extra":
          {  } } ],
  "callbacks": [],
  "messages":
    [ { "name": "MessageInfo",
        "locations":
          [ { "lineno": 2,
              "filename": "send-message.js" } ],
        "docs":
          { "summary": "An object representing a chat message to be sent.",
            "links":
              [ "[`sendMessage()`](#sendMessage)" ],
            "examples":
              [ { "title": "Send a chat message from the backend",
                  "body":
                    [ "import wixChatBackend from 'wix-chat-backend';",
                      "",
                      " export function sendChatMessage(messageText, channelId, metadata, sendAsVisitor) {",
                      "   wixChatBackend.sendMessage({",
                      "     \"messageText\": messageText,",
                      "     \"channelId\": channelId,",
                      "     \"metadata\": {metadata},",
                      "     \"sendAsVisitor\": sendAsVisitor",
                      "   })",
                      "   .then( () => {",
                      "     console.log(\"Chat message sent\");",
                      "   })",
                      "   .catch( (error) => {",
                      "     console.log(error);",
                      "   });",
                      " }" ],
                  "extra":
                    {  } } ],
            "extra":
              {  } },
        "members":
          [ { "name": "messageText",
              "type": "string",
              "doc": "The content of the message." },
            { "name": "channelId",
              "type": "string",
              "doc": "The ID of the channel to send the message to. Currently only IDs of business channels are supported." },
            { "name": "metadata",
              "type": "Object",
              "doc": "An object representing additional contextual message information included in a chat message. The site visitor does not see the metadata.",
              "optional": true },
            { "name": "sendAsVisitor",
              "type": "boolean",
              "doc": "Indicates whether the message is sent from the visitor to the business. If `sendAsVisitor` is `true`, the message is sent from the site visitor to the business. If `sendAsVisitor` is `undefined` or `false`, the message is sent from the business to the site visitor. The default is `undefined`.",
              "optional": true } ],
        "extra":
          {  },
        "labels": [] } ],
  "extra":
    { "scopes":
        [ "backend" ] } }