{ "name": "WarmupData",
  "memberOf": "wix-window",
  "mixes": [],
  "labels": [],
  "location":
    { "lineno": 153,
      "filename": "window.js" },
  "docs":
    { "summary": "The Warmup Data API is used to optimize data loading for sites that render both on the server and in the browser, \n allowing costly data fetching operations to be done only once.",
      "description":
        [ "To improve performance the [rendering process](https://support.wix.com/en/article/velo-about-the-page-rendering-process) ",
          " is split in two when possible: once on the server and once in the browser. When that isn't ",
          " possible, all rendering happens in the browser.",
          "",
          " Because rendering can occur twice, ",
          " it's preferred to perform time-consuming tasks only once, such as querying ",
          " collections or working with the results of network requests from external sites. ",
          " If possible, it's best to perform these operations on the server. ",
          "",
          " Requesting the warmup data from the server returns `undefined` in the following situations:",
          " + When browser rendering happens before server-side rendering.",
          " + When there is only browser rendering, for example in case visitors navigate from page to page within a site.",
          "",
          " Your page code must check for these scenarios and provide a fallback alternative for getting the data.",
          "",
          " Use the `warmupData` API and `env` property  of the [Rendering API](https://www.wix.com/velo/reference/wix-window/rendering-obj/env) ",
          " to track when and where your code is running. This lets you selectively run parts of your code.",
          "",
          " > **Notes:**",
          " > + Rendering never occurs server-side when previewing your site.",
          " > + `wix-window.warmupData` replaces the deprecated `wix-window.rendering.warmupData`.",
          " > + Backend rendering only occurs when visitors initially enter the site, and not when visitors navigate from page-to-page within the site.",
          "",
          " To use the Warmup Data API, import `warmupData` from the `wix-window` module:",
          "",
          "   ```javascript",
          "   import { warmupData } from 'wix-window';",
          "   ```" ],
      "links": [],
      "examples": [],
      "extra":
        {  } },
  "properties": [],
  "operations":
    [ { "name": "get",
        "labels": [],
        "nameParams": [],
        "params":
          [ { "name": "key",
              "type": "string",
              "doc": "A name representing the data to return to the client-side. Until rendered, the data is `undefined`." } ],
        "ret":
          { "type": "*",
            "doc": "Returns one of the following: \n  + The data corresponding to the `key` that was set with the `warmupData.set()` function in the backend.\n  + `undefined` if not yet set.\n  + `null` if called while on the server." },
        "locations":
          [ { "lineno": 261,
              "filename": "window.js" } ],
        "docs":
          { "summary": "Gets data from server-side code for use in client-side code.",
            "description":
              [ "A performance best practice is to get warmup data on the server for time-consuming operations, such as querying ",
                " collections or working with the results of network requests from external sites. You can write code that",
                " sets the data from these operations as warmup data on the server. The client-side code can then `get` that data without ",
                " performing the operations again. ",
                "",
                " Getting the `warmupData` data retrieves data that was set on the server and makes the data accessible ",
                " from the client-side.",
                "",
                " You can only get `warmupData` in the client-side code. ",
                " + This function returns `null` if called while on the server.",
                " + If this function runs before `warmupData.set()`, it returns `undefined`.",
                "",
                " > **Notes:** ",
                " > + Rendering never occurs server-side when previewing your site.",
                " > + `wix-window.warmupData` replaces the deprecated `wix-window.rendering.warmupData`. ",
                " > + Server-side rendering only occurs when visitors initially enter the site, and not when visitors navigate from page-to-page within the site." ],
            "links": [],
            "examples":
              [ { "title": "Get the warmup data on the client-side",
                  "body":
                    [ "import wixWindow from 'wix-window';",
                      "",
                      "...",
                      "",
                      "if (wixWindow.rendering.env === \"browser\") {",
                      "  const myMessage = wixWindow.warmupData.get(\"myWarmupMessage\");",
                      "}" ],
                  "extra":
                    {  } },
                { "title": "Use warmup data to send already-retrieved query results from the server to the client-side",
                  "body":
                    [ "import wixData from 'wix-data';",
                      "import wixWindow from 'wix-window';",
                      "",
                      "async function getData() {",
                      "  const results = await wixData.query(\"MyCollection\")",
                      "    .find();",
                      "  if (wixWindow.rendering.env === \"backend\") {",
                      "    wixWindow.warmupData.set(\"myWarmupData\", results.items);",
                      "    wixWindow.warmupData.set(\"myWarmupMessage\", \"Rendering on the server.\");",
                      "  }",
                      "  return results;",
                      "}",
                      "",
                      "$w.onReady(async function () {",
                      "  const defaultMessage = \"Rendering client-side.\"",
                      "  const dataResults = wixWindow.warmupData.get(\"myWarmupData\") || await getData();",
                      "  const message = wixWindow.warmupData.get(\"myWarmupMessage\") || defaultMessage;",
                      "  $w(\"#retrievedData\").text = JSON.stringify(dataResults);",
                      "  $w(\"#retrievedMessage\").text = message;",
                      "});" ],
                  "extra":
                    { "description": "This example demonstrates how to use `warmupData` to optimize performance between server-side and client-side page \n rendering.\n \n The example has a `getData()` function that performs a query on a `MyCollection` collection. \n\n If this operation happens to run on the server, the results are set for later client-side use. The `wixWindow.rendering.env` property\n indicates if the run is occurring on the server (`backend`) or on the client-side (`browser`). \n\n When rendering on the client-side, the client-side code checks if the query results already exist. If so, there is no need to perform the same query again. \n If not, the client-side code runs the query. \n\n Two text boxes are defined on the page: `retrievedMessage` displays a message about where the rendering occurred and `retrievedData` displays the query items." } } ],
            "extra":
              {  } },
        "extra":
          {  } },
      { "name": "set",
        "labels": [],
        "nameParams": [],
        "params":
          [ { "name": "key",
              "type": "string",
              "doc": "A name representing the data to return to the client-side. Key names are unique within a site. Using the same key name within the same site code overwrites the corresponding data." },
            { "name": "data",
              "type": "*",
              "doc": "The data to return to the client-side." } ],
        "ret":
          { "type": "void" },
        "locations":
          [ { "lineno": 227,
              "filename": "window.js" } ],
        "docs":
          { "summary": "Sets data in server-side code for use in client-side code.",
            "description":
              [ "A performance best practice is to set warmup data for time-consuming operations, such as querying ",
                " collections or working with the results of network requests from external sites. You can write code that",
                " sets the data from these operations as warmup data on the server. The client-side code can then `get` that data without ",
                " performing the operations again. ",
                "",
                " You can only set `warmupData` on the server. This function has no effect if called from client-side code.",
                "",
                " > **Notes:** ",
                " > + Rendering never occurs server-side when previewing your site.",
                " > + `wix-window.warmupData` replaces the deprecated `wix-window.rendering.warmupData`. ",
                " > + Server-side rendering only occurs when visitors initially enter the site, and not when visitors navigate from page-to-page within the site." ],
            "links": [],
            "examples":
              [ { "title": "Set the warmup data on the server",
                  "body":
                    [ "import wixWindow from 'wix-window';",
                      "",
                      "...",
                      "",
                      "if (wixWindow.rendering.env === \"backend\") {",
                      "  wixWindow.warmupData.set(\"myWarmupMessage\", \"Now rendering on the server.\");",
                      "}" ],
                  "extra":
                    {  } },
                { "title": "Use warmup data to send already-retrieved query results from the server to the client-side",
                  "body":
                    [ "import wixData from 'wix-data';",
                      "import wixWindow from 'wix-window';",
                      "",
                      "async function getData() {",
                      "  const results = await wixData.query(\"MyCollection\")",
                      "    .find();",
                      "  if (wixWindow.rendering.env === \"backend\") {",
                      "    wixWindow.warmupData.set(\"myWarmupData\", results.items);",
                      "    wixWindow.warmupData.set(\"myWarmupMessage\", \"Rendering on the server.\");",
                      "  }",
                      "  return results;",
                      "}",
                      "",
                      "$w.onReady(async function () {",
                      "  const defaultMessage = \"Rendering client-side.\"",
                      "  const dataResults = wixWindow.warmupData.get(\"myWarmupData\") || await getData();",
                      "  const message = wixWindow.warmupData.get(\"myWarmupMessage\") || defaultMessage;",
                      "  $w(\"#retrievedData\").text = JSON.stringify(dataResults);",
                      "  $w(\"#retrievedMessage\").text = message;",
                      "});" ],
                  "extra":
                    { "description": "This example demonstrates how to use `warmupData` to optimize performance between server-side and browser rendering.\n \n The example has a `getData()` function that performs a query on a `MyCollection` collection. \n\n If this operation happens to run on the server, the results are set for later browser use. The `wixWindow.rendering.env` property\n indicates if the run is occurring on the server (`backend`) or on the client-side (`browser`). \n\n When rendering in the browser, the client-side code checks if the query results already exist. If so, there is no need to perform the same query again. \n If not, the client-side code runs the query. \n\n Two text boxes are defined on the page: `retrievedMessage` displays a message about where the rendering occurred and `retrievedData` displays the query items." } } ],
            "extra":
              {  } },
        "extra":
          {  } } ],
  "callbacks": [],
  "messages": [],
  "extra":
    {  } }