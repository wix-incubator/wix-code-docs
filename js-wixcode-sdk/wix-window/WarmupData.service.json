{ "name": "WarmupData",
  "memberOf": "wix-window",
  "mixes": [],
  "labels": [],
  "location":
    { "lineno": 115,
      "filename": "window.js" },
  "docs":
    { "summary": "The Warmup Data API is used to optimize data loading for sites that render both on the server and in the browser, \n allowing costly data fetching operations to be done only once.",
      "description":
        [ "To improve performance the [rendering process](https://dev.wix.com/docs/develop-websites/articles/coding-with-velo/frontend-code/page-rendering/about-page-rendering) ",
          " is split in 2 when possible: once on the server and once in the browser. When that's not ",
          " possible, all rendering happens in the browser.",
          "",
          " Because rendering can occur twice, ",
          " it's preferred to perform time-consuming tasks only once, such as querying ",
          " collections or working with the results of network requests from external sites. ",
          " If possible, it's best to perform these operations on the server. ",
          "",
          " Requesting the warmup data from the server returns `undefined` in the following situations:",
          " + When browser rendering happens before server-side rendering.",
          " + When there is only browser rendering, for example in case visitors navigate from page to page within a site.",
          "",
          " The page page code must check for these scenarios and provide a fallback alternative for getting the data.",
          "",
          " Use the Warm Up Data API and `env` property  of the Rendering API",
          " to track when and where your code is running. This lets you selectively run parts of your code.",
          "",
          " > **Notes:**",
          " > + Rendering never occurs server-side when previewing a site.",
          " > + Backend rendering only occurs when site visitors initially enter a site, and not when site visitors navigate from page-to-page within a site.",
          "",
          " To use the Warmup Data API, import `warmupData` from the `wix-window` module:",
          "",
          "   ```javascript",
          "   import { warmupData } from 'wix-window';",
          "   ```" ],
      "links": [],
      "examples": [],
      "extra":
        {  } },
  "properties": [],
  "operations":
    [ { "name": "get",
        "labels": [],
        "nameParams": [],
        "params":
          [ { "name": "key",
              "type": "string",
              "doc": "A name representing the data to return to the client-side. Until rendered, the data is `undefined`." } ],
        "ret":
          { "type": "*",
            "doc": "Returns one of the following: \n  + The data corresponding to the `key` that was set with the `warmupData.set()` method in the backend.\n  + `undefined` if not yet set.\n  + `null` if called while on the server." },
        "locations":
          [ { "lineno": 220,
              "filename": "window.js" } ],
        "docs":
          { "summary": "Retrieves data from server-side code for use in client-side code.",
            "description":
              [ "A performance best practice is to get warmup data on the server for time-consuming operations, such as querying ",
                " collections or working with the results of network requests from external sites. You can write code that",
                " sets the data from these operations as warmup data on the server. The client-side code can then `get` that data without ",
                " performing the operations again. ",
                "",
                " Getting the warmup data retrieves data that was set on the server and makes the data accessible ",
                " from the client-side.",
                "",
                " You can only get warmup data in the client-side code. ",
                " + This method returns `null` if called while on the server.",
                " + If this method runs before `warmupData.set()`, it returns `undefined`.",
                "",
                " > **Notes:** ",
                " > + Rendering never occurs server-side when previewing a site.",
                " > + Server-side rendering only occurs when site visitors initially enter a site, and not when site visitors navigate from page-to-page within a site." ],
            "links": [],
            "examples":
              [ { "title": "Get the warmup data on the client-side",
                  "body":
                    [ "import wixWindowFrontend from 'wix-window-frontend';",
                      "",
                      "...",
                      "",
                      "if (wixWindowFrontend.rendering.env === \"browser\") {",
                      "  const myMessage = wixWindowFrontend.warmupData.get(\"myWarmupMessage\");",
                      "}" ],
                  "extra":
                    {  } },
                { "title": "Use warmup data to send already-retrieved query results from the server to the client-side",
                  "body":
                    [ "import wixData from 'wix-data';",
                      "import wixWindowFrontend from 'wix-window-frontend';",
                      "",
                      "async function getData() {",
                      "  const results = await wixData.query(\"MyCollection\")",
                      "    .find();",
                      "  if (wixWindowFrontend.rendering.env === \"backend\") {",
                      "    wixWindowFrontend.warmupData.set(\"myWarmupData\", results.items);",
                      "    wixWindowFrontend.warmupData.set(\"myWarmupMessage\", \"Rendering on the server.\");",
                      "  }",
                      "  return results;",
                      "}",
                      "",
                      "$w.onReady(async function () {",
                      "  const defaultMessage = \"Rendering client-side.\"",
                      "  const dataResults = wixWindowFrontend.warmupData.get(\"myWarmupData\") || await getData();",
                      "  const message = wixWindowFrontend.warmupData.get(\"myWarmupMessage\") || defaultMessage;",
                      "  $w(\"#retrievedData\").text = JSON.stringify(dataResults);",
                      "  $w(\"#retrievedMessage\").text = message;",
                      "});" ],
                  "extra":
                    { "description": "This example demonstrates how to use warmup data to optimize performance between server-side and client-side page \n rendering.\n \n The example has a `getData()` method that performs a query on a `MyCollection` collection. \n\n If this operation happens to run on the server, the results are set for later client-side use. The `wixWindow.rendering.env` property\n indicates if the run is occurring on the server (`backend`) or on the client-side (`browser`). \n\n When rendering on the client-side, the client-side code checks if the query results already exist. If so, there is no need to perform the same query again. \n If not, the client-side code runs the query. \n\n 2 text boxes are defined on the page: `retrievedMessage` displays a message about where the rendering occurred and `retrievedData` displays the query items." } } ],
            "extra":
              {  } },
        "extra":
          {  } },
      { "name": "set",
        "labels": [],
        "nameParams": [],
        "params":
          [ { "name": "key",
              "type": "string",
              "doc": "A name representing the data to return to the client-side. Key names are unique within a site. Using the same key name within the same site code overwrites the corresponding data." },
            { "name": "data",
              "type": "*",
              "doc": "The data to return to the client-side." } ],
        "ret":
          { "type": "void" },
        "locations":
          [ { "lineno": 187,
              "filename": "window.js" } ],
        "docs":
          { "summary": "Sets data in server-side code for use in client-side code.",
            "description":
              [ "A performance best practice is to set warmup data for time-consuming operations, such as querying ",
                " collections or working with the results of network requests from external sites. You can write code that",
                " sets the data from these operations as warmup data on the server. The client-side code can then `get` that data without ",
                " performing the operations again. ",
                "",
                " You can only set warmup data on the server. This method has no effect if called from client-side code.",
                "",
                " > **Notes:** ",
                " > + Rendering never occurs server-side when previewing a site.",
                " > + Server-side rendering only occurs when site visitors initially enter a site, and not when site visitors navigate from page-to-page within a site." ],
            "links": [],
            "examples":
              [ { "title": "Set the warmup data on the server",
                  "body":
                    [ "import wixWindowFrontend from 'wix-window-frontend';",
                      "",
                      "...",
                      "",
                      "if (wixWindowFrontend.rendering.env === \"backend\") {",
                      "  wixWindowFrontend.warmupData.set(\"myWarmupMessage\", \"Now rendering on the server.\");",
                      "}" ],
                  "extra":
                    {  } },
                { "title": "Use warmup data to send already-retrieved query results from the server to the client-side",
                  "body":
                    [ "import wixData from 'wix-data';",
                      "import wixWindowFrontend from 'wix-window-frontend';",
                      "",
                      "async function getData() {",
                      "  const results = await wixData.query(\"MyCollection\")",
                      "    .find();",
                      "  if (wixWindowFrontend.rendering.env === \"backend\") {",
                      "    wixWindowFrontend.warmupData.set(\"myWarmupData\", results.items);",
                      "    wixWindowFrontend.warmupData.set(\"myWarmupMessage\", \"Rendering on the server.\");",
                      "  }",
                      "  return results;",
                      "}",
                      "",
                      "$w.onReady(async function () {",
                      "  const defaultMessage = \"Rendering client-side.\"",
                      "  const dataResults = wixWindowFrontend.warmupData.get(\"myWarmupData\") || await getData();",
                      "  const message = wixWindowFrontend.warmupData.get(\"myWarmupMessage\") || defaultMessage;",
                      "  $w(\"#retrievedData\").text = JSON.stringify(dataResults);",
                      "  $w(\"#retrievedMessage\").text = message;",
                      "});" ],
                  "extra":
                    { "description": "This example demonstrates how to use `warmupData` to optimize performance between server-side and browser rendering.\n \n The example has a `getData()` method that performs a query on a `MyCollection` collection. \n\n If this operation happens to run on the server, the results are set for later browser use. The `wixWindow.rendering.env` property\n indicates if the run is occurring on the server (`backend`) or on the client-side (`browser`). \n\n When rendering in the browser, the client-side code checks if the query results already exist. If so, there is no need to perform the same query again. \n If not, the client-side code runs the query. \n\n 2 text boxes are defined on the page: `retrievedMessage` displays a message about where the rendering occurred and `retrievedData` displays the query items." } } ],
            "extra":
              {  } },
        "extra":
          {  } } ],
  "callbacks": [],
  "messages": [],
  "extra":
    {  } }