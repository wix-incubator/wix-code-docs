{ "name": "Hooks",
  "memberOf": "wix-data",
  "mixes": [],
  "labels": [],
  "location":
    { "lineno": 14,
      "filename": "hooks.es6" },
  "docs":
    { "summary": "Hooks that can be added to wix-data operations.",
      "description":
        [ "Data hooks run code before or after certain interactions with your site's\r collections. A data hook allows you to intercept the interaction immediately\r before or immediately after it occurs. The hook's code can even be used to\r affect the interaction itself. For example, you may want to intercept an\r item before it is added to your collection to perform a final validation or\r tweak the data that actually makes it into the collection.\r\r In general, hooks are run whether the interaction with your collection is\r initiated by a page element, programmatically, or when using the Data Manager.\r However, a Data API call from the backend code of your site may pass the\r optional [`WixDataOptions`](wix-data.html#WixDataOptions) object and use it\r to suppress hooks from being called on that particular operation.\r\r To add a hook to a collection, in the Data Manager click on the **Hooks**\r button and choose which hooks to add. Code for the hooks is written in\r the **data.js** file which resides in **Backend** section of your site.\r Hook functions are defined using the following pattern:\r\r ``` javascript\r export function <collectionName>_<hookName>(<parameters>) { }\r ```" ],
      "links": [],
      "examples": [],
      "extra":
        {  } },
  "properties": [],
  "operations":
    [ { "name": "afterCount",
        "labels": [],
        "nameParams": [],
        "params":
          [ { "name": "count",
              "type": "number",
              "doc": "The number of items the count operation has found." },
            { "name": "context",
              "type": "wix-data.Hooks.HookContext",
              "doc": "Contextual information about the hook." } ],
        "ret":
          { "type":
              [ { "name": "Promise",
                  "typeParams":
                    [ "number" ] },
                "number" ],
            "doc": "The count to return to [`count()`](wix-data.WixDataQuery.html#count) instead of the original count.\r Returning a rejected promise will not block the operation, but will return a rejected promise to the caller as well as trigger the [`onFailure()`](#onFailure) hook." },
        "locations":
          [ { "lineno": 42,
              "filename": "hooks.es6" } ],
        "docs":
          { "summary": "A hook that is triggered after a `count()` operation.",
            "description":
              [ "The `afterCount()` hook runs when:\r\r + The [`count()`](wix-data.WixDataQuery.html#count) function is called.\r + The collection is viewed in the Data Manager.\r\r\r Return a number or a Promise that resolves to number from the `afterCount()`\r function. The returned number will be used as the result of the call to\r [`count()`](wix-data.WixDataQuery.html#count) instead of the actual count of\r items found in the collection. If returning a Promise, the number is used as\r the result, whether the Promise is fulfilled or rejected.\r\r If the returned value is of the wrong type, the value is ignored.\r\r A rejected Promise also calls the [`onFailure()`](#onFailure) hook if it has\r been registered." ],
            "links": [],
            "examples":
              [ { "title": "A hook after a count",
                  "body":
                    [ "// In data.js\r",
                      "\r",
                      "export function myCollection_afterCount(count, context) {\r",
                      "  let originalCount = count;  // 5\r",
                      "  let hookContext = context;  // see below\r",
                      "\r",
                      "  // some change to the received count\r",
                      "\r",
                      "  return newCount;\r",
                      "}\r",
                      "\r",
                      "/*\r",
                      " * hookContext:\r",
                      " *\r",
                      " * {\r",
                      " *   \"collectionName\": \"myCollection\",\r",
                      " *   \"userId\":         \"f45jf8d2-grkj-2opd-4ovk-9rfj4wo5tvj3\",\r",
                      " *   \"userRole\":       \"siteOwner\"\r",
                      " * }\r",
                      " */" ],
                  "extra":
                    {  } },
                { "title": "Change the count",
                  "body":
                    [ "// In data.js\r",
                      "\r",
                      "export function myCollection_afterCount(count, context) {\r",
                      "  let originalCount = count;  // 5\r",
                      "  let hookContext = context;  // see below\r",
                      "\r",
                      "  // some change to the received count\r",
                      "  let newCount = originalCount + 1;\r",
                      "\r",
                      "  return newCount;\r",
                      "}\r",
                      "\r",
                      "/*\r",
                      " * hookContext:\r",
                      " *\r",
                      " * {\r",
                      " *   \"collectionName\": \"myCollection\",\r",
                      " *   \"userId\":         \"f45jf8d2-grkj-2opd-4ovk-9rfj4wo5tvj3\",\r",
                      " *   \"userRole\":       \"siteOwner\"\r",
                      " * }\r",
                      " */" ],
                  "extra":
                    {  } } ],
            "extra":
              {  } },
        "extra":
          {  } },
      { "name": "afterGet",
        "labels": [],
        "nameParams": [],
        "params":
          [ { "name": "item",
              "type": "Object",
              "doc": "The item that was retrieved from the collection." },
            { "name": "context",
              "type": "wix-data.Hooks.HookContext",
              "doc": "Contextual information about the hook." } ],
        "ret":
          { "type":
              [ { "name": "Promise",
                  "typeParams":
                    [ "Object" ] },
                "Object" ],
            "doc": "The item to return to [`get()`](wix-data.html#get) instead of the retrieved item.\r Returning a rejected promise will not block the operation, but will return a rejected promise to the operation caller as well as trigger the [`onFailure()`](#onFailure) hook." },
        "locations":
          [ { "lineno": 73,
              "filename": "hooks.es6" } ],
        "docs":
          { "summary": "A hook that is triggered after a `get()` operation.",
            "description":
              [ "The `afterGet()` hook runs when the [`get()`](wix-data.html#get)\r function is called.\r\r The hook does not run when the [`find`](wix-data.WixDataQuery.html#find)\r function is called or when a dataset retrieves items from the collection it\r is connected to.\r\r Return an object or a Promise that resolves to an object from the `afterGet()`\r function. The returned object will be used as the result of the call to the\r [`get()`](wix-data.html#get) function instead of the actual item found in the\r collection. If returning a Promise, the object is used as the result, whether\r the Promise is fulfilled or rejected.\r\r If the returned value is of the wrong type, the value is ignored.\r\r A rejected Promise also calls the [`onFailure()`](#onFailure) hook if it has\r been registered." ],
            "links": [],
            "examples":
              [ { "title": "A hook after a get",
                  "body":
                    [ "// In data.js\r",
                      "\r",
                      "export function myCollection_afterGet(item, context) {\r",
                      "  let hookContext = context;  // see below\r",
                      "\r",
                      "  // some changes to the received item\r",
                      "\r",
                      "  return item;\r",
                      "}\r",
                      "\r",
                      "/*\r",
                      " * hookContext:\r",
                      " *\r",
                      " * {\r",
                      " *   \"collectionName\": \"myCollection\",\r",
                      " *   \"userId\":         \"f45jf8d2-grkj-2opd-4ovk-9rfj4wo5tvj3\",\r",
                      " *   \"userRole\":       \"siteOwner\"\r",
                      " * }\r",
                      " */" ],
                  "extra":
                    {  } },
                { "title": "Change the retrieved item",
                  "body":
                    [ "// In data.js\r",
                      "\r",
                      "export function myCollection_afterGet(item, context) {\r",
                      "  let hookContext = context;  // see below\r",
                      "\r",
                      "  // some changes to the received item\r",
                      "  item.full_name = item.first_name + \" \" + item.last_name;\r",
                      "\r",
                      "  return item;\r",
                      "}\r",
                      "\r",
                      "/*\r",
                      " * hookContext:\r",
                      " *\r",
                      " * {\r",
                      " *   \"collectionName\": \"myCollection\",\r",
                      " *   \"userId\":         \"f45jf8d2-grkj-2opd-4ovk-9rfj4wo5tvj3\",\r",
                      " *   \"userRole\":       \"siteOwner\"\r",
                      " * }\r",
                      " */" ],
                  "extra":
                    {  } } ],
            "extra":
              {  } },
        "extra":
          {  } },
      { "name": "afterInsert",
        "labels": [],
        "nameParams": [],
        "params":
          [ { "name": "item",
              "type": "Object",
              "doc": "The item that was inserted." },
            { "name": "context",
              "type": "wix-data.Hooks.HookContext",
              "doc": "Contextual information about the hook." } ],
        "ret":
          { "type":
              [ { "name": "Promise",
                  "typeParams":
                    [ "Object" ] },
                "Object" ],
            "doc": "The item to return to [`insert()`](wix-data.html#insert) instead of the inserted item.\r Returning a rejected promise will not block the operation, but will return a rejected promise to the caller as well as trigger the [`onFailure()`](#onFailure) hook." },
        "locations":
          [ { "lineno": 105,
              "filename": "hooks.es6" } ],
        "docs":
          { "summary": "A hook that is triggered after an `insert()` operation.",
            "description":
              [ "The `afterInsert()` hook runs when:\r\r + The [`insert()`](wix-data.html#insert) function is called.\r + An action is performed on a dataset that inserts a new item into the collection.\r + An item is inserted using the Data Manager.\r + An item is imported into the collection. (Sandbox only.)\r\r\r Return an object or a Promise that resolves to an object from the `afterInsert()`\r function. The returned object will be used as the result of the call to the\r [`insert()`](wix-data.html#insert) function instead of the actual item inserted\r into the collection. If returning a Promise, the object is used as the result,\r whether the Promise is fulfilled or rejected.\r\r If the returned value is of the wrong type, the value is ignored.\r\r A rejected Promise also calls the [`onFailure()`](#onFailure) hook if it has\r been registered.\r\r Because the `afterInsert` hook is called after the [`insert()`](wix-data.html#insert)\r is executed, it cannot affect the item that is inserted into the collection.\r It can only affect the item returned by [`insert()`](wix-data.html#insert)." ],
            "links": [],
            "examples":
              [ { "title": "A hook after an insert",
                  "body":
                    [ "// In data.js\r",
                      "\r",
                      "export function myCollection_afterInsert(item, context) {\r",
                      "  let hookContext = context;  // see below\r",
                      "\r",
                      "  // some changes to the received item\r",
                      "\r",
                      "  return item;\r",
                      "}\r",
                      "\r",
                      "/*\r",
                      " * hookContext:\r",
                      " *\r",
                      " * {\r",
                      " *   \"collectionName\": \"myCollection\",\r",
                      " *   \"userId\":         \"f45jf8d2-grkj-2opd-4ovk-9rfj4wo5tvj3\",\r",
                      " *   \"userRole\":       \"siteOwner\"\r",
                      " * }\r",
                      " */" ],
                  "extra":
                    {  } },
                { "title": "Change the retrieved item",
                  "body":
                    [ "// In data.js\r",
                      "\r",
                      "export function myCollection_afterInsert(item, context) {\r",
                      "  let hookContext = context;  // see below\r",
                      "\r",
                      "  // some changes to the received item\r",
                      "  item.full_name = item.first_name + \" \" + item.last_name;\r",
                      "\r",
                      "  return item;\r",
                      "}\r",
                      "\r",
                      "/*\r",
                      " * hookContext:\r",
                      " *\r",
                      " * {\r",
                      " *   \"collectionName\": \"myCollection\",\r",
                      " *   \"userId\":         \"f45jf8d2-grkj-2opd-4ovk-9rfj4wo5tvj3\",\r",
                      " *   \"userRole\":       \"siteOwner\"\r",
                      " * }\r",
                      " */" ],
                  "extra":
                    {  } } ],
            "extra":
              {  } },
        "extra":
          {  } },
      { "name": "afterQuery",
        "labels": [],
        "nameParams": [],
        "params":
          [ { "name": "item",
              "type": "Object",
              "doc": "One of the items of the query result. The hook is called for each item in the results." },
            { "name": "context",
              "type": "wix-data.Hooks.HookContext",
              "doc": "Contextual information about the hook." } ],
        "ret":
          { "type":
              [ { "name": "Promise",
                  "typeParams":
                    [ "Object" ] },
                "Object" ],
            "doc": "The item to return to [`find`](wix-data.WixDataQuery.html#find) instead of the item retrieved from the database.\r Returning a rejected promise will not block the operation, but will return a rejected promise to the operation caller as well as trigger the [`onFailure()`](#onFailure) hook." },
        "locations":
          [ { "lineno": 142,
              "filename": "hooks.es6" } ],
        "docs":
          { "summary": "A hook that is triggered after a `find` operation, for each of the items in the query results.",
            "description":
              [ "The `afterQuery()` hook runs when:\r\r + The [`find`](wix-data.WixDataQuery.html#find) function is called.\r + An action is performed on a dataset that retrieves items from the collection.\r + The collection is viewed in the Data Manager.\r + An item is imported into the collection. (Sandbox only.)\r + An item is exported from the collection. (Sandbox only.)\r\r\r The hook runs once for each item in the collection.\r\r Return an object or a Promise that resolves to an object from the `afterQuery()`\r function. The returned object will be used as the result of the call to the\r [`find`](wix-data.WixDataQuery.html#find) function instead of the actual item\r found in the collection. If returning a Promise, the object is used as the\r result, whether the Promise is fulfilled or rejected.\r\r If the returned value is of the wrong type, the value is ignored.\r\r A rejected Promise also calls the [`onFailure()`](#onFailure) hook if it has\r been registered." ],
            "links": [],
            "examples":
              [ { "title": "A hook after a find",
                  "body":
                    [ "// In data.js\r",
                      "\r",
                      "export function myCollection_afterQuery(item, context) {\r",
                      "  let hookContext = context;  // see below\r",
                      "\r",
                      "  // some changes to the received item\r",
                      "\r",
                      "  return item;\r",
                      "}\r",
                      "\r",
                      "/*\r",
                      " * hookContext:\r",
                      " *\r",
                      " * {\r",
                      " *   \"collectionName\": \"myCollection\",\r",
                      " *   \"userId\":         \"f45jf8d2-grkj-2opd-4ovk-9rfj4wo5tvj3\",\r",
                      " *   \"userRole\":       \"siteOwner\"\r",
                      " * }\r",
                      " */" ],
                  "extra":
                    {  } },
                { "title": "Change the retrieved item",
                  "body":
                    [ "// In data.js\r",
                      "\r",
                      "export function myCollection_afterQuery(item, context) {\r",
                      "  let hookContext = context;  // see below\r",
                      "\r",
                      "  // some changes to the received item\r",
                      "  item.full_name = item.first_name + \" \" + item.last_name;\r",
                      "\r",
                      "  return item;\r",
                      "}\r",
                      "\r",
                      "/*\r",
                      " * hookContext:\r",
                      " *\r",
                      " * {\r",
                      " *   \"collectionName\": \"myCollection\",\r",
                      " *   \"userId\":         \"f45jf8d2-grkj-2opd-4ovk-9rfj4wo5tvj3\",\r",
                      " *   \"userRole\":       \"siteOwner\"\r",
                      " * }\r",
                      " */" ],
                  "extra":
                    {  } } ],
            "extra":
              {  } },
        "extra":
          {  } },
      { "name": "afterRemove",
        "labels": [],
        "nameParams": [],
        "params":
          [ { "name": "item",
              "type": "Object",
              "doc": "The item that was removed." },
            { "name": "context",
              "type": "wix-data.Hooks.HookContext",
              "doc": "Contextual information about the hook." } ],
        "ret":
          { "type":
              [ { "name": "Promise",
                  "typeParams":
                    [ "Object" ] },
                "Object" ],
            "doc": "The item to return to [`remove()`](wix-data.html#remove) instead of the deleted item.\r Returning a rejected promise will not block the operation, but will return a rejected promise to the caller as well as trigger the [`onFailure()`](#onFailure) hook." },
        "locations":
          [ { "lineno": 179,
              "filename": "hooks.es6" } ],
        "docs":
          { "summary": "A hook that is triggered after a `remove()` operation.",
            "description":
              [ "The `afterRemove()` hook runs when:\r\r + The [`remove()`](wix-data.html#remove) function is called.\r + An action is performed on a dataset that removes an item from the collection.\r + An item is deleted using the Data Manager.\r\r\r Return an object or a Promise that resolves to an object. The returned object\r will be used as the result of the call to the [`remove()`](wix-data.html#remove)\r function instead of the actual item removed from the collection. If returning a\r Promise, the object is used as the result, whether the Promise is fulfilled or rejected.\r\r If the returned value is of the wrong type, the value is ignored.\r\r A rejected Promise also calls the [`onFailure()`](#onFailure) hook if it has\r been registered.\r\r Because the `afterRemove()` hook is called after the [`remove()`](wix-data.html#remove)\r is executed, it cannot prevent the item from being removed from the collection.\r It can only affect the item returned by [`remove()`](wix-data.html#remove)." ],
            "links": [],
            "examples":
              [ { "title": "A hook after a remove",
                  "body":
                    [ "// In data.js\r",
                      "\r",
                      "export function myCollection_afterRemove(item, context) {\r",
                      "  let hookContext = context;  // see below\r",
                      "\r",
                      "  // some changes to the removed item\r",
                      "\r",
                      "  return item;\r",
                      "}\r",
                      "\r",
                      "/*\r",
                      " * hookContext:\r",
                      " *\r",
                      " * {\r",
                      " *   \"collectionName\": \"myCollection\",\r",
                      " *   \"userId\":         \"f45jf8d2-grkj-2opd-4ovk-9rfj4wo5tvj3\",\r",
                      " *   \"userRole\":       \"siteOwner\"\r",
                      " * }\r",
                      " */" ],
                  "extra":
                    {  } },
                { "title": "Change the retrieved item",
                  "body":
                    [ "// In data.js\r",
                      "\r",
                      "export function myCollection_afterUpdate(item, context) {\r",
                      "  let hookContext = context;  // see below\r",
                      "\r",
                      "  // some changes to the removed item\r",
                      "  item.full_name = item.first_name + \" \" + item.last_name;\r",
                      "\r",
                      "  return item;\r",
                      "}\r",
                      "\r",
                      "/*\r",
                      " * hookContext:\r",
                      " *\r",
                      " * {\r",
                      " *   \"collectionName\": \"myCollection\",\r",
                      " *   \"userId\":         \"f45jf8d2-grkj-2opd-4ovk-9rfj4wo5tvj3\",\r",
                      " *   \"userRole\":       \"siteOwner\"\r",
                      " * }\r",
                      " */" ],
                  "extra":
                    {  } } ],
            "extra":
              {  } },
        "extra":
          {  } },
      { "name": "afterUpdate",
        "labels": [],
        "nameParams": [],
        "params":
          [ { "name": "item",
              "type": "Object",
              "doc": "The updated item." },
            { "name": "context",
              "type": "wix-data.Hooks.HookContext",
              "doc": "Contextual information about the hook." } ],
        "ret":
          { "type":
              [ { "name": "Promise",
                  "typeParams":
                    [ "Object" ] },
                "Object" ],
            "doc": "The item to return to [`update()`](wix-data.html#update) instead of the updated item.\r Returning a rejected promise will not block the operation, but will return a rejected promise to the caller as well as trigger the [`onFailure()`](#onFailure) hook." },
        "locations":
          [ { "lineno": 214,
              "filename": "hooks.es6" } ],
        "docs":
          { "summary": "A hook that is triggered after an `update()` operation.",
            "description":
              [ "The `afterUpdate()` hook runs when:\r\r + The [`update()`](wix-data.html#update) function is called.\r + An action is performed on a dataset that updates an item from the collection.\r + An item is updated using the Data Manager.\r\r\r Return an object or a Promise that resolves to an object from the `afterUpdate()`\r function. The returned object will be used as the result of the call to the\r [`update()`](wix-data.html#update) function instead of the actual item updated\r in the collection. If returning a Promise, the object is used as the result,\r whether the Promise is fulfilled or rejected.\r\r If the returned value is of the wrong type, the value is ignored.\r\r A rejected Promise also calls the [`onFailure()`](#onFailure) hook if it has\r been registered.\r\r Because the `afterUpdate` hook is called after the [`update()`](wix-data.html#update)\r is executed, it cannot affect the item that is being updated in the collection.\r It can only affect the item returned by [`update()`](wix-data.html#update)." ],
            "links": [],
            "examples":
              [ { "title": "A hook after an update",
                  "body":
                    [ "// In data.js\r",
                      "\r",
                      "export function myCollection_afterUpdate(item, context) {\r",
                      "  let hookContext = context;  // see below\r",
                      "\r",
                      "  // some changes to the received item\r",
                      "\r",
                      "  return item;\r",
                      "}\r",
                      "\r",
                      "/*\r",
                      " * hookContext:\r",
                      " *\r",
                      " * {\r",
                      " *   \"collectionName\": \"myCollection\",\r",
                      " *   \"userId\":         \"f45jf8d2-grkj-2opd-4ovk-9rfj4wo5tvj3\",\r",
                      " *   \"userRole\":       \"siteOwner\"\r",
                      " * }\r",
                      " */" ],
                  "extra":
                    {  } },
                { "title": "Change the retrieved item",
                  "body":
                    [ "// In data.js\r",
                      "\r",
                      "export function myCollection_afterUpdate(item, context) {\r",
                      "  let hookContext = context;  // see below\r",
                      "\r",
                      "  // some changes to the received item\r",
                      "  item.full_name = item.first_name + \" \" + item.last_name;\r",
                      "\r",
                      "  return item;\r",
                      "}\r",
                      "\r",
                      "/*\r",
                      " * hookContext:\r",
                      " *\r",
                      " * {\r",
                      " *   \"collectionName\": \"myCollection\",\r",
                      " *   \"userId\":         \"f45jf8d2-grkj-2opd-4ovk-9rfj4wo5tvj3\",\r",
                      " *   \"userRole\":       \"siteOwner\"\r",
                      " * }\r",
                      " */" ],
                  "extra":
                    {  } } ],
            "extra":
              {  } },
        "extra":
          {  } },
      { "name": "beforeCount",
        "labels": [],
        "nameParams": [],
        "params":
          [ { "name": "query",
              "type": "wix-data.WixDataQuery",
              "doc": "The original query as defined by [`count()`](wix-data.WixDataQuery.html#count)." },
            { "name": "context",
              "type": "wix-data.Hooks.HookContext",
              "doc": "Contextual information about the hook." } ],
        "ret":
          { "type":
              [ { "name": "Promise",
                  "typeParams":
                    [ "wix-data.WixDataQuery" ] },
                "wix-data.WixDataQuery" ],
            "doc": "The `query` to be used for the [`count()`](wix-data.WixDataQuery.html#count) operation instead of the original query.\r Returning a rejected promise will block the operation and will return a rejected promise to the caller as well as trigger the [`onFailure()`](#onFailure) hook." },
        "locations":
          [ { "lineno": 250,
              "filename": "hooks.es6" } ],
        "docs":
          { "summary": "A hook that is triggered before a `count()` operation.",
            "description":
              [ "The `beforeCount()` hook runs when:\r\r + The [`count()`](wix-data.WixDataQuery.html#count) function is called.\r + The collection is viewed in the Data Manager.\r\r\r Return a query or a Promise that resolves to a query from the `beforeCount()`\r function. The returned query will be used as the query for the\r [`count()`](wix-data.WixDataQuery.html#count) operation.\r\r Often, you will modify the query that is received in the `query` parameter\r by calling one or more [`WixDataQuery`](wix-data.WixDataQuery.html) functions.\r\r If the returned value is of the wrong type, the value is ignored.\r\r A rejected Promise blocks the call to [`count()`](wix-data.WixDataQuery.html#count)\r and also calls the [`onFailure()`](#onFailure) hook if it has been registered.\r\r Because the `beforeCount()` hook is called before [`count()`](wix-data.WixDataQuery.html#count)\r is executed, it can affect how items are counted or block the [`count()`](wix-data.WixDataQuery.html#count)." ],
            "links": [],
            "examples":
              [ { "title": "A hook before a count",
                  "body":
                    [ "// In data.js\r",
                      "\r",
                      "export function myCollection_beforeCount(query, context) {\r",
                      "  let hookContext = context;  // see below\r",
                      "\r",
                      "  // some change to the received query\r",
                      "\r",
                      "  return newQuery;\r",
                      "}\r",
                      "\r",
                      "/*\r",
                      " * hookContext:\r",
                      " *\r",
                      " * {\r",
                      " *   \"collectionName\": \"myCollection\",\r",
                      " *   \"userId\":         \"f45jf8d2-grkj-2opd-4ovk-9rfj4wo5tvj3\",\r",
                      " *   \"userRole\":       \"siteOwner\"\r",
                      " * }\r",
                      " */" ],
                  "extra":
                    {  } },
                { "title": "Change the count",
                  "body":
                    [ "// In data.js\r",
                      "\r",
                      "export function myCollection_beforeCount(query, context) {\r",
                      "  let hookContext = context;  // see below\r",
                      "\r",
                      "  // some change to the received query\r",
                      "  let newQuery = query.eq(\"status\", \"active\");\r",
                      "\r",
                      "  return newQuery;\r",
                      "}\r",
                      "\r",
                      "/*\r",
                      " * hookContext:\r",
                      " *\r",
                      " * {\r",
                      " *   \"collectionName\": \"myCollection\",\r",
                      " *   \"userId\":         \"f45jf8d2-grkj-2opd-4ovk-9rfj4wo5tvj3\",\r",
                      " *   \"userRole\":       \"siteOwner\"\r",
                      " * }\r",
                      " */" ],
                  "extra":
                    {  } } ],
            "extra":
              {  } },
        "extra":
          {  } },
      { "name": "beforeGet",
        "labels": [],
        "nameParams": [],
        "params":
          [ { "name": "itemId",
              "type": "string",
              "doc": "The ID of the original item to be retrieved." },
            { "name": "context",
              "type": "wix-data.Hooks.HookContext",
              "doc": "Contextual information about the hook." } ],
        "ret":
          { "type":
              [ { "name": "Promise",
                  "typeParams":
                    [ "string" ] },
                "string" ],
            "doc": "The ID to be used for the [`get()`](wix-data.html#get) operation instead of the original `itemId` specified by the caller.\r Returning a rejected promise will block the operation and will return a rejected promise to the caller as well as trigger the [`onFailure()`](#onFailure) hook." },
        "locations":
          [ { "lineno": 285,
              "filename": "hooks.es6" } ],
        "docs":
          { "summary": "A hook that is triggered before a `get()` operation.",
            "description":
              [ "The `beforeGet()` hook runs when the [`get()`](wix-data.html#get)\r function is called.\r\r The hook does not run when the [`find`](wix-data.WixDataQuery.html#find)\r function is called or when a dataset retrieves items from the collection it\r is connected to.\r\r Return a string or a Promise that resolves to a string from the `beforeGet()`\r function. The returned string will be used as the `itemId` parameter for the\r [`get()`](wix-data.html#get) operation. The item with the new `itemId` will\r be retrieved instead of the item with the original `itemId`.\r\r If the returned value is of the wrong type, the value is ignored.\r\r A rejected Promise blocks the call to [`get()`](wix-data.html#get)\r and also calls the [`onFailure()`](#onFailure) hook if it has been registered.\r\r Because the `beforeGet()` hook is called before [`get()`](wix-data.html#get)\r is executed, it can affect which item is retrieved\r or block the [`get()`](wix-data.html#get)." ],
            "links": [],
            "examples":
              [ { "title": "A hook before a get",
                  "body":
                    [ "// In data.js\r",
                      "\r",
                      "export function myCollection_beforeGet(itemId, context) {\r",
                      "  let hookContext = context;  // see below\r",
                      "\r",
                      "  // change the item to get\r",
                      "\r",
                      "  return newItemId;\r",
                      "}\r",
                      "\r",
                      "/*\r",
                      " * hookContext:\r",
                      " *\r",
                      " * {\r",
                      " *   \"collectionName\": \"myCollection\",\r",
                      " *   \"userId\":         \"f45jf8d2-grkj-2opd-4ovk-9rfj4wo5tvj3\",\r",
                      " *   \"userRole\":       \"siteOwner\"\r",
                      " * }\r",
                      " */" ],
                  "extra":
                    {  } },
                { "title": "Change the item to get",
                  "body":
                    [ "// In data.js\r",
                      "\r",
                      "export function myCollection_beforeGet(itemId, context) {\r",
                      "  let hookContext = context;  // see below\r",
                      "\r",
                      "  // change the item to get\r",
                      "  let newItemId = \"1234\";\r",
                      "\r",
                      "  return newItemId;\r",
                      "}\r",
                      "\r",
                      "/*\r",
                      " * hookContext:\r",
                      " *\r",
                      " * {\r",
                      " *   \"collectionName\": \"myCollection\",\r",
                      " *   \"userId\":         \"f45jf8d2-grkj-2opd-4ovk-9rfj4wo5tvj3\",\r",
                      " *   \"userRole\":       \"siteOwner\"\r",
                      " * }\r",
                      " */" ],
                  "extra":
                    {  } } ],
            "extra":
              {  } },
        "extra":
          {  } },
      { "name": "beforeInsert",
        "labels": [],
        "nameParams": [],
        "params":
          [ { "name": "item",
              "type": "Object",
              "doc": "The original item to be inserted." },
            { "name": "context",
              "type": "wix-data.Hooks.HookContext",
              "doc": "Contextual information about the hook." } ],
        "ret":
          { "type":
              [ { "name": "Promise",
                  "typeParams":
                    [ "Object" ] },
                "Object" ],
            "doc": "The item to be inserted instead of the original item specified by the caller.\r Returning a rejected promise will block the operation and will return a rejected promise to the caller as well as trigger the [`onFailure()`](#onFailure) hook." },
        "locations":
          [ { "lineno": 320,
              "filename": "hooks.es6" } ],
        "docs":
          { "summary": "A hook that is triggered before an `insert()` operation.",
            "description":
              [ "The `beforeInsert()` hook runs when:\r\r + The [`insert()`](wix-data.html#insert) function is called.\r + An action is performed on a dataset that inserts a new item into the collection.\r + An item is inserted using the Data Manager.\r + An item is imported into the collection. (Sandbox only.)\r\r\r The hook also runs when an action is performed on a dataset that inserts a\r new item into the collection that the dataset is connected to.\r\r Return an object or a Promise that resolves to an object from the `beforeInsert()`\r function. The returned object will be inserted into the collection instead of\r the original item passed to the [`insert()`](wix-data.html#insert) function.\r\r If the returned value is of the wrong type, the value is ignored.\r\r A rejected Promise blocks the call to [`insert()`](wix-data.html#insert)\r and also calls the [`onFailure()`](#onFailure) hook if it has been registered.\r\r Because the `beforeInsert()` hook is called before [`insert()`](wix-data.html#insert)\r is executed, it can affect the item that is inserted into the collection\r or block the [`insert()`](wix-data.html#insert)." ],
            "links": [],
            "examples":
              [ { "title": "A hook before an insert",
                  "body":
                    [ "// In data.js\r",
                      "\r",
                      "export function myCollection_beforeInsert(item, context) {\r",
                      "  let hookContext = context;  // see below\r",
                      "\r",
                      "  // some change to the received item\r",
                      "\r",
                      "  return item;\r",
                      "}\r",
                      "\r",
                      "/*\r",
                      " * hookContext:\r",
                      " *\r",
                      " * {\r",
                      " *   \"collectionName\": \"myCollection\",\r",
                      " *   \"userId\":         \"f45jf8d2-grkj-2opd-4ovk-9rfj4wo5tvj3\",\r",
                      " *   \"userRole\":       \"siteOwner\"\r",
                      " * }\r",
                      " */" ],
                  "extra":
                    {  } },
                { "title": "Change the item to insert",
                  "body":
                    [ "// In data.js\r",
                      "\r",
                      "export function myCollection_beforeInsert(item, context) {\r",
                      "  let hookContext = context;  // see below\r",
                      "\r",
                      "  // some change to the received item\r",
                      "  item.title = toUpperFirst(item.title);\r",
                      "  item.first_name = toUpperFirst(item.first_name);\r",
                      "  item.last_name = toUpperFirst(item.last_name);\r",
                      "\r",
                      "  return item;\r",
                      "}\r",
                      "\r",
                      "function toUpperFirst(s) {\r",
                      "  return s.charAt(0).toUpperCase() + s.slice(1);\r",
                      "}\r",
                      "\r",
                      "/*\r",
                      " * hookContext:\r",
                      " *\r",
                      " * {\r",
                      " *   \"collectionName\": \"myCollection\",\r",
                      " *   \"userId\":         \"f45jf8d2-grkj-2opd-4ovk-9rfj4wo5tvj3\",\r",
                      " *   \"userRole\":       \"siteOwner\"\r",
                      " * }\r",
                      " */" ],
                  "extra":
                    {  } } ],
            "extra":
              {  } },
        "extra":
          {  } },
      { "name": "beforeQuery",
        "labels": [],
        "nameParams": [],
        "params":
          [ { "name": "query",
              "type": "wix-data.WixDataQuery",
              "doc": "The original query as specified by the caller." },
            { "name": "context",
              "type": "wix-data.Hooks.HookContext",
              "doc": "Contextual information about the hook." } ],
        "ret":
          { "type":
              [ { "name": "Promise",
                  "typeParams":
                    [ "wix-data.WixDataQuery" ] },
                "wix-data.WixDataQuery" ],
            "doc": "The query to use instead of the original query specified by the caller.\r Returning a rejected promise will block the operation and will return a rejected promise to the operation caller as well as trigger the [`onFailure()`](#onFailure) hook." },
        "locations":
          [ { "lineno": 358,
              "filename": "hooks.es6" } ],
        "docs":
          { "summary": "A hook that is triggered before a `find()` operation.",
            "description":
              [ "The `beforeQuery()` hook runs when:\r\r + The [`find`](wix-data.WixDataQuery.html#find) function is called.\r + An action is performed on a dataset that retrieves items from the collection.\r + The collection is viewed in the Data Manager.\r + An item is imported into the collection. (Sandbox only.)\r + An item is exported from the collection. (Sandbox only.)\r\r\r The hook also runs when an action is performed on a dataset that retrieves\r items from the collection that the dataset is connected to.\r\r Return a query or a Promise that resolves to a query from the `beforeQuery()`\r function. The returned query will be used as the query for the\r [`find`](wix-data.WixDataQuery.html#find) operation.\r\r Often, you will modify the query that is received in the `query` parameter\r by calling one or more [`WixDataQuery`](wix-data.WixDataQuery.html) functions.\r\r If the returned value is of the wrong type, the value is ignored.\r\r A rejected Promise blocks the call to [`find()`](wix-data.WixDataQuery.html#find)\r and also calls the [`onFailure()`](#onFailure) hook if it has been registered.\r\r Because the `beforeQuery()` hook is called before [`find()`](wix-data.WixDataQuery.html#find)\r is executed, it can affect the query that is used to retrieve items\r or block the [`find()`](wix-data.WixDataQuery.html#find)." ],
            "links": [],
            "examples":
              [ { "title": "A hook before a find",
                  "body":
                    [ "// In data.js\r",
                      "\r",
                      "export function myCollection_beforeQuery(query, context) {\r",
                      "  let hookContext = context;  // see below\r",
                      "\r",
                      "  // some change to the received query\r",
                      "\r",
                      "  return newQuery;\r",
                      "}\r",
                      "\r",
                      "/*\r",
                      " * hookContext:\r",
                      " *\r",
                      " * {\r",
                      " *   \"collectionName\": \"myCollection\",\r",
                      " *   \"userId\":         \"f45jf8d2-grkj-2opd-4ovk-9rfj4wo5tvj3\",\r",
                      " *   \"userRole\":       \"siteOwner\"\r",
                      " * }\r",
                      " */" ],
                  "extra":
                    {  } },
                { "title": "Change the query",
                  "body":
                    [ "// In data.js\r",
                      "\r",
                      "export function myCollection_beforeQuery(query, context) {\r",
                      "  let hookContext = context;  // see below\r",
                      "\r",
                      "  // some change to the received query\r",
                      "  let newQuery = query.eq(\"status\", \"active\");\r",
                      "\r",
                      "  return newQuery;\r",
                      "}\r",
                      "\r",
                      "/*\r",
                      " * hookContext:\r",
                      " *\r",
                      " * {\r",
                      " *   \"collectionName\": \"myCollection\",\r",
                      " *   \"userId\":         \"f45jf8d2-grkj-2opd-4ovk-9rfj4wo5tvj3\",\r",
                      " *   \"userRole\":       \"siteOwner\"\r",
                      " * }\r",
                      " */" ],
                  "extra":
                    {  } } ],
            "extra":
              {  } },
        "extra":
          {  } },
      { "name": "beforeRemove",
        "labels": [],
        "nameParams": [],
        "params":
          [ { "name": "itemId",
              "type": "string",
              "doc": "The ID of the original item to be removed." },
            { "name": "context",
              "type": "wix-data.Hooks.HookContext",
              "doc": "Contextual information about the hook." } ],
        "ret":
          { "type":
              [ { "name": "Promise",
                  "typeParams":
                    [ "string" ] },
                "string" ],
            "doc": "The ID to be used for the [`remove()`](wix-data.html#remove) instead of the original `itemId` specified by the caller.\r Returning a rejected promise will block the operation and will return a rejected promise to the caller as well as trigger the [`onFailure()`](#onFailure) hook." },
        "locations":
          [ { "lineno": 400,
              "filename": "hooks.es6" } ],
        "docs":
          { "summary": "A hook that is called before a `remove()` operation.",
            "description":
              [ "The `beforeRemove()` hook runs when:\r\r + The [`remove()`](wix-data.html#remove) function is called.\r + An action is performed on a dataset that removes an item from the collection.\r + An item is deleted using the Data Manager.\r\r\r The hook also runs when an action is performed on a dataset that removes\r an item from the collection that the dataset is connected to.\r\r Return a string or a Promise that resolves to a string from the `beforeRemove()`\r function. The returned string will be used as the `itemId` parameter for the\r [`remove()`](wix-data.html#remove) operation. The item with the new `itemId`\r will be removed instead of the item with the original `itemId`.\r\r If the returned value is of the wrong type, the value is ignored.\r\r A rejected Promise blocks the call to [`remove()`](wix-data.html#remove)\r and also calls the [`onFailure()`](#onFailure) hook if it has been registered.\r\r Because the `beforeRemove()` hook is called before [`remove()`](wix-data.html#remove)\r is executed, it can affect the item that is removed from the collection\r or block the [`remove()`](wix-data.html#remove)." ],
            "links": [],
            "examples":
              [ { "title": "A hook before a remove",
                  "body":
                    [ "// In data.js\r",
                      "\r",
                      "export function myCollection_beforeRemove(itemId, context) {\r",
                      "  let hookContext = context;  // see below\r",
                      "\r",
                      "  // change to the item to remove\r",
                      "\r",
                      "  return newItemId;\r",
                      "}\r",
                      "\r",
                      "/*\r",
                      " * hookContext:\r",
                      " *\r",
                      " * {\r",
                      " *   \"collectionName\": \"myCollection\",\r",
                      " *   \"userId\":         \"f45jf8d2-grkj-2opd-4ovk-9rfj4wo5tvj3\",\r",
                      " *   \"userRole\":       \"siteOwner\"\r",
                      " * }\r",
                      " */" ],
                  "extra":
                    {  } },
                { "title": "Change the item to remove",
                  "body":
                    [ "// In data.js\r",
                      "\r",
                      "export function myCollection_beforeRemove(itemId, context) {\r",
                      "  let hookContext = context;  // see below\r",
                      "\r",
                      "  // change to the item to remove\r",
                      "  let newItemId = \"1234\";\r",
                      "\r",
                      "  return newItemId;\r",
                      "}\r",
                      "\r",
                      "/*\r",
                      " * hookContext:\r",
                      " *\r",
                      " * {\r",
                      " *   \"collectionName\": \"myCollection\",\r",
                      " *   \"userId\":         \"f45jf8d2-grkj-2opd-4ovk-9rfj4wo5tvj3\",\r",
                      " *   \"userRole\":       \"siteOwner\"\r",
                      " * }\r",
                      " */" ],
                  "extra":
                    {  } } ],
            "extra":
              {  } },
        "extra":
          {  } },
      { "name": "beforeUpdate",
        "labels": [],
        "nameParams": [],
        "params":
          [ { "name": "item",
              "type": "Object",
              "doc": "The original item to be updated." },
            { "name": "context",
              "type": "wix-data.Hooks.HookContext",
              "doc": "Contextual information about the hook." } ],
        "ret":
          { "type":
              [ { "name": "Promise",
                  "typeParams":
                    [ "Object" ] },
                "Object" ],
            "doc": "The item to be updated instead of the original item specified by the caller.\r Returning a rejected promise will block the operation and will return a rejected promise to the caller as well as trigger the [`onFailure()`](#onFailure) hook." },
        "locations":
          [ { "lineno": 438,
              "filename": "hooks.es6" } ],
        "docs":
          { "summary": "A hook that is triggered before an `update()` operation.",
            "description":
              [ "The `beforeUpdate()` hook runs when:\r\r + The [`update()`](wix-data.html#update) function is called.\r + An action is performed on a dataset that updates an item from the collection.\r + An item is updated using the Data Manager.\r\r\r The hook also runs when an action is performed on a dataset that updates\r an item from the collection that the dataset is connected to.\r\r Return an object or a Promise that resolves to an object from the `beforeUpdate()`\r function. The returned object will be updated in the collection instead of\r the original item passed to the [`update()`](wix-data.html#update) function.\r\r If the returned value is of the wrong type, the value is ignored.\r\r A rejected Promise blocks the call to [`update()`](wix-data.html#update)\r and also calls the [`onFailure()`](#onFailure) hook if it has been registered.\r\r Because the `beforeUpdate()` hook is called before the [`update()`](wix-data.html#update)\r is executed, it can affect the item that is updated in the collection\r or block the [`update()`](wix-data.html#update)." ],
            "links": [],
            "examples":
              [ { "title": "A hook before an update",
                  "body":
                    [ "// In data.js\r",
                      "\r",
                      "export function myCollection_beforeUpdate(item, context) {\r",
                      "  let hookContext = context;  // see below\r",
                      "\r",
                      "  // some change to the received item\r",
                      "\r",
                      "  return item;\r",
                      "}\r",
                      "\r",
                      "/*\r",
                      " * hookContext:\r",
                      " *\r",
                      " * {\r",
                      " *   \"collectionName\": \"myCollection\",\r",
                      " *   \"userId\":         \"f45jf8d2-grkj-2opd-4ovk-9rfj4wo5tvj3\",\r",
                      " *   \"userRole\":       \"siteOwner\"\r",
                      " * }\r",
                      " */" ],
                  "extra":
                    {  } },
                { "title": "Change the item to update",
                  "body":
                    [ "// In data.js\r",
                      "\r",
                      "export function myCollection_beforeUpdate(item, context) {\r",
                      "  let hookContext = context;  // see below\r",
                      "\r",
                      "  // some change to the received item\r",
                      "  item.title = toUpperFirst(item.title);\r",
                      "  item.first_name = toUpperFirst(item.first_name);\r",
                      "  item.last_name = toUpperFirst(item.last_name);\r",
                      "\r",
                      "  return item;\r",
                      "}\r",
                      "\r",
                      "function toUpperFirst(s) {\r",
                      "  return s.charAt(0).toUpperCase() + s.slice(1);\r",
                      "}\r",
                      "\r",
                      "/*\r",
                      " * hookContext:\r",
                      " *\r",
                      " * {\r",
                      " *   \"collectionName\": \"myCollection\",\r",
                      " *   \"userId\":         \"f45jf8d2-grkj-2opd-4ovk-9rfj4wo5tvj3\",\r",
                      " *   \"userRole\":       \"siteOwner\"\r",
                      " * }\r",
                      " */" ],
                  "extra":
                    {  } } ],
            "extra":
              {  } },
        "extra":
          {  } },
      { "name": "onFailure",
        "labels": [],
        "nameParams": [],
        "params":
          [ { "name": "error",
              "type": "Error",
              "doc": "The error that caused the failure." },
            { "name": "context",
              "type": "wix-data.Hooks.HookContext",
              "doc": "Contextual information about the hook." } ],
        "ret":
          { "type":
              { "name": "Promise",
                "typeParams":
                  [ "Object" ] },
            "doc": "Fulfilled - Returning a fulfilled promise will result in a fulfilled data operation with the provided result.\nRejected - Returning a rejected promise will result in returning a rejected promise to the caller of the data operation." },
        "locations":
          [ { "lineno": 475,
              "filename": "hooks.es6" } ],
        "docs":
          { "summary": "A hook that is triggered on any error or rejected Promise from any of the wix-data operations.",
            "description":
              [ "The `onFailure()` hook is triggered whenever a wix-data operation or hook returns a\rrejected Promise or an error." ],
            "links": [],
            "examples":
              [ { "title": "A hook when a failure occurs",
                  "body":
                    [ "// In data.js\r",
                      "\r",
                      "export function myCollection_onFailure(error, context) {\r",
                      "  let hookError = error;  // see below\r",
                      "\r",
                      "  // handle error\r",
                      "\r",
                      "  return ret;\r",
                      "}\r",
                      "\r",
                      "/*\r",
                      " * hookError:\r",
                      " *\r",
                      " * {\r",
                      " *   \"message\": \"An item with _id [1234] already exists.\",\r",
                      " *   \"code\":    -409\r",
                      " * }\r",
                      " */" ],
                  "extra":
                    {  } } ],
            "extra":
              {  } },
        "extra":
          {  } } ],
  "callbacks": [],
  "messages":
    [ { "name": "HookContext",
        "locations":
          [ { "lineno": 1,
              "filename": "hooks.es6" } ],
        "docs":
          { "summary": "An object that contains contextual information about the hook being called.",
            "links": [],
            "examples": [],
            "extra":
              {  } },
        "members":
          [ { "name": "collectionName",
              "type": "string",
              "doc": "The name of the collection the hook affects." },
            { "name": "userId",
              "type": "string",
              "doc": "The current site user id. If no user is logged in to the site it may be null." },
            { "name": "userRole",
              "type": "string",
              "doc": "The permissions role of the current user. Possibilities are: `anonymous`, `siteMember`,  `siteOwner` and `dataOwner`." },
            { "name": "currentItem",
              "type": "Object",
              "doc": "The item stored in the database before an `update` or `delete` operation.\rWill be `undefined` for all other operations." } ],
        "extra":
          {  },
        "labels": [] } ],
  "extra":
    {  },
  "relatedContent":
    [ { "icon": "example",
        "text": "Prevent Database Duplicates",
        "url": "https://www.wix.com/code/home/forum/wix-tips-and-updates/example-no-database-duplicates" },
      { "icon": "article",
        "text": "About Data Hooks",
        "url": "https://support.wix.com/en/article/wix-code-about-data-hooks" },
      { "icon": "article",
        "text": "Using Data Hooks",
        "url": "https://support.wix.com/en/article/wix-code-how-to-use-data-hooks" },
      { "icon": "article",
        "text": "Processing User Input Before It's Stored in a Collection with Data Hooks",
        "url": "https://support.wix.com/en/article/wix-code-tutorial-processing-user-input-before-it-is-stored-in-a-collection-with-data-hooks" } ],
  "FAQs":
    [ { "title": "What is a hook?",
        "markdown": "Data hooks run code before or after certain interactions with your site's collections. A data hook allows you to intercept the interaction immediately before or immediately after it occurs.\n\nFor example, you may want to intercept an item before it is added to your collection to perform a final validation or tweak the data that actually makes it into the collection." },
      { "title": "How do I add a hook to a collection?",
        "markdown": "In the [Data Manager](https://support.wix.com/en/article/accessing-your-sandbox-and-live-data), click the **Hooks** button and choose which hooks to add. Code for the hooks is written in the **data.js** file which resides in **Backend** section of your site. Hook functions are defined using the following pattern:\n\n`export function <collectionName>_<hookName>(<parameters>) { }`\n\n[Learn more](https://support.wix.com/en/article/wix-code-using-data-hooks)." },
      { "title": "Can I use a hook to cancel a data operation?",
        "markdown": "Yes. You can return a rejected promise from a \"before\" hook to cancel the data operation." } ] }